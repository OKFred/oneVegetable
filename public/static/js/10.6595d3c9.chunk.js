(this["webpackJsonperp-dashboard"]=this["webpackJsonperp-dashboard"]||[]).push([[10],{374:function(e,t,r){"use strict";var n=r(25),a=r(1);t.a=Object(n.a)(Object(a.jsx)("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"}),"Folder")},376:function(e,t,r){"use strict";var n=r(25),a=r(1);t.a=Object(n.a)(Object(a.jsx)("path",{d:"M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.9959.9959 0 0 0-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"}),"ModeEdit")},435:function(e,t,r){"use strict";r.r(t);var n=r(35),a=r.n(n),o=r(8),c=r(53),l=r(13),i=r(0),s=r(16),u=r(23),d=r(268),p=r(22),b=r(87),f={enUS:{folder:{currentFolder:"please select",needFolderName:"please input name for new folder",addNewFolder:"add new folder",folderNull:"folder not found",dataNull:"data not found"},action:{uploadSuccess:"upload success"},table:{tableHeader:"photo",id:"photo id",group_id:"group id",group_name:"folder name",file_name:"file name",file_size:"file size",gmt_modified:"date modified",owner_member_display_name:"owner",reference_count:"reference count",url:"link"},tableToolbar:{menuHide:"hide menu",menuShow:"show menu",photoUpload:"upload",photoDownload:"download"},common:{yes:"OK",no:"Cancel",netFail:"request failed"}},zhCN:{folder:{currentFolder:"\u8bf7\u9009\u62e9",needFolderName:"\u8bf7\u586b\u5199\u6587\u4ef6\u5939\u540d",addNewFolder:"\u65b0\u5efa\u6587\u4ef6\u5939",folderNull:"\u6587\u4ef6\u5939\u4e0d\u5b58\u5728",dataNull:"\u6570\u636e\u4e0d\u5b58\u5728"},action:{uploadSuccess:"\u4e0a\u4f20\u6210\u529f"},table:{tableHeader:"\u56fe\u7247",id:"\u56fe\u7247 id",group_id:"\u5206\u7ec4 id",group_name:"\u6587\u4ef6\u5939",file_name:"\u6587\u4ef6\u540d",file_size:"\u6587\u4ef6\u5927\u5c0f",gmt_modified:"\u4fee\u6539\u65e5\u671f",owner_member_display_name:"\u7528\u6237\u540d",reference_count:"\u5f15\u7528\u6b21\u6570",url:"\u94fe\u63a5"},tableToolbar:{menuHide:"\u9690\u85cf\u83dc\u5355",menuShow:"\u663e\u793a\u83dc\u5355",photoUpload:"\u4e0a\u4f20",photoDownload:"\u4e0b\u8f7d"},common:{yes:"\u786e\u5b9a",no:"\u53d6\u6d88",netFail:"\u8bf7\u6c42\u5931\u8d25"}}},j=r(108),h=r(85),g=r(388),m=r(277),O=r(446),x=r(361),v=r(293),w=r(269),y=r(5),k=r(2),C=r(9),_=r(65),F=r(6),P=r(10),z=r(48),S=r(51);function R(e){return Object(z.a)("MuiFormGroup",e)}Object(S.a)("MuiFormGroup",["root","row","error"]);var N=r(31),H=r(38),M=r(1),I=["className","row"],T=Object(F.a)("div",{name:"MuiFormGroup",slot:"Root",overridesResolver:function(e,t){var r=e.ownerState;return[t.root,r.row&&t.row]}})((function(e){var t=e.ownerState;return Object(k.a)({display:"flex",flexDirection:"column",flexWrap:"wrap"},t.row&&{flexDirection:"row"})})),D=i.forwardRef((function(e,t){var r=Object(P.a)({props:e,name:"MuiFormGroup"}),n=r.className,a=r.row,o=void 0!==a&&a,c=Object(y.a)(r,I),l=Object(N.a)(),i=Object(H.a)({props:r,muiFormControl:l,states:["error"]}),s=Object(k.a)({},r,{row:o,error:i.error}),u=function(e){var t=e.classes,r={root:["root",e.row&&"row",e.error&&"error"]};return Object(_.a)(r,R,t)}(s);return Object(M.jsx)(T,Object(k.a)({className:Object(C.a)(u.root,n),ownerState:s,ref:t},c))})),q=r(448),A=r(374),V=r(375),W=r(376),G=r(377),U=r(378),E=r(25),L=Object(E.a)(Object(M.jsx)("path",{d:"M3 9h14V7H3v2zm0 4h14v-2H3v2zm0 4h14v-2H3v2zm16 0h2v-2h-2v2zm0-10v2h2V7h-2zm0 6h2v-2h-2v2z"}),"Toc"),Q=Object(E.a)(Object(M.jsx)("path",{d:"M22 16V4c0-1.1-.9-2-2-2H8c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h12c1.1 0 2-.9 2-2zm-11-4 2.03 2.71L16 11l4 5H8l3-4zM2 6v14c0 1.1.9 2 2 2h14v-2H4V6H2z"}),"Collections"),B=r(339),J=r(340),K=r(427),X=[];var Y=function(e){var t=e.folderArr,r=e.currentFolder,n=e.setCurrentFolder,o=e.manageFolder,s=e.uploadPhotos,u=e.setPage,d=e.displayMode,p=e.setDisplayMode,b=e.langPack,f=Object(i.useState)(!1),y=Object(l.a)(f,2),k=y[0],C=y[1],_=Object(i.useState)(!1),F=Object(l.a)(_,2),P=F[0],z=F[1];function S(){C(""),z(!1)}function R(){return(R=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("add",{group_name:k});case 2:return e.sent&&(n(""),S()),e.abrupt("return");case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function N(){return(N=Object(c.a)(a.a.mark((function e(){var t;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,o("rename",{group_id:r,group_name:k});case 2:return t=e.sent,console.log(t),t&&S(),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function H(){return(H=Object(c.a)(a.a.mark((function e(){return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o("delete",{group_id:r}),n(""),S(),e.abrupt("return");case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function I(){return(I=Object(c.a)(a.a.mark((function e(){var t,r,n;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=Object(j.a)(X),e.prev=1,t.s();case 3:if((r=t.n()).done){e.next=9;break}return n=r.value,e.next=7,s(n);case 7:e.next=3;break;case 9:e.next=14;break;case 11:e.prev=11,e.t0=e.catch(1),t.e(e.t0);case 14:return e.prev=14,t.f(),e.finish(14);case 17:X=[];case 18:case"end":return e.stop()}}),e,null,[[1,11,14,17]])})))).apply(this,arguments)}return t&&t.length?Object(M.jsx)("span",{style:{marginTop:"20px"},children:P?Object(M.jsx)(M.Fragment,{children:"add"===P?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(w.a,{sx:{height:"30px",marginRight:"10px"},variant:"outlined",color:"secondary",type:"text",placeholder:b.folder.addNewFolder,onChange:function(e){return C(e.target.value.trim())}}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(B.a,{}),onClick:function(){return R.apply(this,arguments)},children:b.common.yes}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(J.a,{}),onClick:function(){return z(!1)},children:b.common.no})]}):"edit"===P?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(w.a,{sx:{height:"30px",marginRight:"10px"},variant:"outlined",color:"primary",type:"text",defaultValue:t.find((function(e){return e.id===r})).name,onChange:function(e){return C(e.target.value.trim())}}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(B.a,{}),onClick:function(){return N.apply(this,arguments)},children:b.common.yes}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(J.a,{}),onClick:function(){return z(!1)},children:b.common.no})]}):"delete"===P?Object(M.jsxs)(M.Fragment,{children:[Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(B.a,{}),onClick:function(){return H.apply(this,arguments)},children:b.common.yes}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(J.a,{}),onClick:function(){return z(!1)},children:b.common.no})]}):"upload"===P?Object(M.jsx)(M.Fragment,{children:Object(M.jsxs)(D,{children:[Object(M.jsx)(q.a,{sx:{border:"1px dotted",height:"200px",margin:"20px",justifyContent:"center"},labelPlacement:"top",control:Object(M.jsx)(w.a,{type:"file",inputProps:{multiple:!0}}),label:Object(M.jsx)(K.a,{fontSize:"large"}),onChange:function(e){var t=e.target.files;X=t.length?t:[]}}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(B.a,{}),onClick:function(){return I.apply(this,arguments)},children:b.common.yes}),Object(M.jsx)(v.a,{startIcon:Object(M.jsx)(J.a,{}),onClick:function(){return z(!1)},children:b.common.no})]})}):""}):Object(M.jsxs)(M.Fragment,{children:[Object(M.jsxs)(g.a,{"aria-label":"breadcrumb",sx:{display:"inline-block",marginRight:"5px"},children:[Object(M.jsx)(A.a,{}),Object(M.jsxs)(m.a,{sx:{height:"30px",minWidth:"100px"},autoWidth:!0,value:r,onChange:function(e){var t=e.target.value;t&&t!==b.folder.currentFolder&&(u(0),n(t))},children:[Object(M.jsx)(O.a,{value:b.folder.currentFolder,disabled:!0,children:b.folder.currentFolder}),t.map((function(e,t){return Object(M.jsx)(O.a,{value:e.id,children:e.name},t)}))]})]}),Object(M.jsxs)(x.a,{variant:"",children:[Object(M.jsx)(v.a,{onClick:function(){return z("add")},children:Object(M.jsx)(V.a,{})}),Object(M.jsx)(v.a,{onClick:function(){if(r&&r!==b.folder.currentFolder){z("edit");var e=t.find((function(e){return e.id===r}));e&&C(e.name)}},disabled:!r||r===b.folder.currentFolder,children:Object(M.jsx)(W.a,{})}),Object(M.jsx)(v.a,{onClick:function(){return z("delete")},disabled:!r||r===b.folder.currentFolder,children:Object(M.jsx)(G.a,{})}),Object(M.jsx)(v.a,{onClick:function(){return z("upload")},disabled:!r||r===b.folder.currentFolder,children:Object(M.jsx)(U.a,{})}),Object(M.jsx)(v.a,{onClick:function(){return p("gallery"===d?"table":"gallery")},disabled:!r||r===b.folder.currentFolder,children:"gallery"===d?Object(M.jsx)(L,{}):Object(M.jsx)(Q,{})})]})]})}):Object(M.jsx)(h.a,{variant:"body2",children:b.folder.folderNull})},Z=r(434);var $=function(e){var t=e.page,r=e.page_size,n=e.handleChangePage,a=e.handleChangeRowsPerPage;return Object(M.jsx)(Z.a,{component:"div",labelDisplayedRows:function(e){var t=e.from,r=e.to;return"".concat(t,"\u2013").concat(r)},sx:{"& .MuiTablePagination-toolbar":{height:"29px",padding:"1px"}},page:t,count:-1,onPageChange:function(e,t){return n(t)},rowsPerPage:r,onRowsPerPageChange:function(e){return a(parseInt(e.target.value))}})},ee=r(450),te=r(451),re=r(452),ne=r(288),ae=r(426);var oe=function(e){var t=e.photoArr,r=e.photoSizing,n=e.photoCols,a=e.rowHeight,c=e.currentFolder,l=e.langPack,i=r.width,s=r.height;return t&&t.length?Object(M.jsx)(ee.a,{cols:n,rowHeight:a,sx:{marginTop:"1px",marginBottom:"60px"},variant:"standard",gap:2,children:t.map((function(e){return Object(M.jsxs)(te.a,{cols:1,rows:1,children:[Object(M.jsx)("img",Object(o.a)(Object(o.a)({},srcset(e.url,i,s,1,1)),{},{alt:e.file_name,loading:"lazy"})),Object(M.jsx)(re.a,{sx:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0) 100%)"},title:e.file_name,position:"top",actionIcon:Object(M.jsx)(ne.a,{sx:{color:e.reference_count?"yellow":"white"},"aria-label":"star ".concat(e.file_name),children:Object(M.jsx)(ae.a,{})}),actionPosition:"left"})]},e.url)}))}):Object(M.jsx)(h.a,{variant:"body2",sx:{margin:"10px"},children:c===l.folder.currentFolder?l.folder.currentFolder:l.folder.dataNull})},ce=r(431),le=r(456),ie=r(419),se=r(420),ue=r(421),de=r(422),pe=r(457),be=[];var fe=function(e){var t=e.tableRows,r=e.tableColumns,n=e.page_size,a=e.page,o=e.localization,c=e.handleChangePage,l=e.handleChangeRowsPerPage,i=e.onRowClick,s=e.langPack,u=window.innerHeight>520?window.innerHeight-320:600;return Object(M.jsx)("div",{style:{height:u,width:"100%"},children:Object(M.jsx)(ce.a,{checkboxSelection:!0,localeText:"zhCN"===o.locale?le.a.components.MuiDataGrid.defaultProps.localeText:{},components:{Toolbar:function(){return Object(M.jsxs)(ie.a,{children:[Object(M.jsx)(se.a,{}),Object(M.jsx)(ue.a,{}),Object(M.jsx)(de.a,{}),Object(M.jsx)(pe.a,{csvOptions:{utf8WithBom:!0,fileName:s.table.tableHeader+"_"+new Date((new Date).valueOf()-60*(new Date).getTimezoneOffset()*1e3).toISOString().replace(/T.*/,"")}})]})}},onRowClick:i,onStateChange:function(e){var r=e.selection;r.length!==be.length&&(be=r.map((function(e){return t.find((function(t){return t.id===e}))})),console.log(be.length+" selected"))},page:a,pageSize:n,rowCount:9999,columns:r,getRowHeight:function(){return 88},rows:t,rowsPerPageOptions:[10,25,100],disableSelectionOnClick:!0,paginationMode:"server",onPageChange:c,onPageSizeChange:l})})};t.default=function(){console.log("photo app running");var e,t=Object(u.c)((function(e){return e.localization})),r=Object(i.useState)(f[t.locale]),n=Object(l.a)(r,2),j=n[0],h=n[1],g=Object(u.c)((function(e){return e.globalization})),m=Object(i.useState)(g.baseData.loginData),O=Object(l.a)(m,1)[0],x=Object(s.f)(),v=Object(i.useState)([]),w=Object(l.a)(v,2),y=w[0],k=w[1],C=Object(i.useState)(j.folder.currentFolder),_=Object(l.a)(C,2),F=_[0],P=_[1],z=Object(i.useState)([]),S=Object(l.a)(z,2),R=S[0],N=S[1],H=Object(i.useState)(0),I=Object(l.a)(H,2),T=I[0],D=I[1],q=Object(i.useState)(10),A=Object(l.a)(q,2),V=A[0],W=A[1],G=Object(i.useState)("gallery"),U=Object(l.a)(G,2),E=U[0],L=U[1],Q=Object(i.useState)([]),B=Object(l.a)(Q,2),J=B[0],K=B[1],X=0,Z=Object(p.a)(),ee=Object(d.a)(Z.breakpoints.down("md"))?3:10;function te(){return(te=Object(c.a)(a.a.mark((function e(t,r){var n,o,c,l,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ma.photoFolderManageQuery({operation:t,groupObj:r}),e.next=3,fetchAPI(n);case 3:if((o=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,o.response.result));case 6:return c=ma.photoFolderManageCheck(o),l=c.response,i=l.status,s=l.result,queryResult(i,"ok"),i&&setTimeout(re,1234),e.abrupt("return",s);case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function re(e){return ne.apply(this,arguments)}function ne(){return(ne=Object(c.a)(a.a.mark((function e(t){var r,n,c,l,i,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=ma.photoFolderQuery(t),e.next=3,fetchAPI(r);case 3:if((n=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,n.response.result));case 6:if(c=ma.photoFolderCheck(n),l=c.response,i=l.status,s=l.result,i){e.next=10;break}return e.abrupt("return",queryResult(!1,s));case 10:return clearTimeout(X),X=setTimeout((function(){var e=s.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{id:String(e.id)})}));k(e)}),1234),e.abrupt("return",s);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return ce.apply(this,arguments)}function ce(){return(ce=Object(c.a)(a.a.mark((function e(t){var r,n,o,c,l,i;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t||(t={}),r=ma.photoQuery(t),e.next=4,fetchAPI(r);case 4:if((n=e.sent).response.status){e.next=7;break}return e.abrupt("return",queryResult(!1,n.response.result));case 7:if(o=ma.photoCheck(n),c=o.response,l=c.status,i=c.result,l){e.next=11;break}return e.abrupt("return",queryResult(!1,i));case 11:return N(i),e.abrupt("return",i);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(){return(le=Object(c.a)(a.a.mark((function t(r){var n,o,c,l,i,s;return a.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=ma.photoUploadQuery({file_name:r.name,image_bytes:r,group_id:F}),t.next=3,fetchAPI(n);case 3:if((o=t.sent).response.status){t.next=6;break}return t.abrupt("return",queryResult(!1,o.response.result));case 6:if(c=ma.photoUploadCheck(o),l=c.response,i=l.status,s=l.result,i){t.next=10;break}return t.abrupt("return",queryResult(i,s));case 10:return queryResult(i,j.action.uploadSuccess),void 0!==e&&clearTimeout(e),e=setTimeout((function(){ae({group_id:F})}),2e3),t.abrupt("return",s);case 14:case"end":return t.stop()}}),t)})))).apply(this,arguments)}Object(i.useEffect)((function(){console.log("display mode changed: ",E)}),[E]),Object(i.useEffect)((function(){h(f[t.locale])}),[t.locale]),Object(i.useEffect)((function(){console.log("current folder:",F),F&&F!==j.folder.currentFolder&&ae({group_id:F,current_page:T+1,page_size:V})}),[F]),Object(i.useEffect)((function(){return console.log("I want pics"),O?(re(),function(e){var t=[{field:"imgWithURL",headerName:j.table.tableHeader,minWidth:50,valueGetter:function(e){return e.row},valueFormatter:function(e){return e.value.url},renderCell:function(e){var t=e.value;return Object(M.jsx)("a",{href:t.url,target:"_blank",children:Object(M.jsx)("img",Object(o.a)(Object(o.a)({},srcset(t.url.split(",")[0],100,100,1,1)),{},{alt:"mainPic"}))})}},{field:"file_name",minWidth:300,headerName:j.table.file_name},{field:"reference_count",flex:1,headerName:j.table.reference_count},{field:"gmt_modified",flex:1,headerName:j.table.gmt_modified}];if(e){e.score&&t.splice(5,0,{field:"final_score",headerName:j.table.score,flex:.5,sortable:!0},{field:"tag",headerName:j.table.tag,flex:.5,sortable:!0})}K(t)}(),function(){console.log("I leave pics")}):x("/")}),[]);var ie=function(e){D(e);var t={current_page:e+1,page_size:V};F&&F!==j.folder.currentFolder&&(t.group_id=F),ae(t)},se=function(e){W(e);var t={current_page:T+1,page_size:e};F&&F!==j.folder.currentFolder&&(t.group_id=F),ae(t)};return Object(M.jsxs)(b.a,{title:"Photos --\u56fe\u5e93",children:[Object(M.jsx)(Y,{folderArr:y,currentFolder:F,setCurrentFolder:P,manageFolder:function(e,t){return te.apply(this,arguments)},uploadPhotos:function(e){return le.apply(this,arguments)},setPage:D,displayMode:E,setDisplayMode:L,langPack:j}),Object(M.jsx)($,{page:T,page_size:V,handleChangePage:ie,handleChangeRowsPerPage:se,langPack:j}),"table"===E?Object(M.jsx)(fe,{tableRows:R,tableColumns:J,page:T,page_size:V,localization:t,handleChangePage:ie,handleChangeRowsPerPage:se,onRowClick:function(e,t){},langPack:j}):Object(M.jsx)(oe,{photoArr:R,rowHeight:150,photoCols:ee,photoSizing:{width:100,height:100},currentFolder:F,langPack:j})]})}}}]);
//# sourceMappingURL=10.6595d3c9.chunk.js.map