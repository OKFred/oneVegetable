(this["webpackJsonperp-dashboard"]=this["webpackJsonperp-dashboard"]||[]).push([[13],{312:function(e,t,n){"use strict";n.d(t,"a",(function(){return r}));var r={enUS:{folder:{currentFolder:"please select",needFolderName:"please input name for new folder",addNewFolder:"add new folder",folderNull:"folder not found",dataNull:"data not found",folderRequired:"please select a folder to continue"},table:{tableHeader:"Products",categoryName:"category name",productId:"product id",subject:"subject",status:"status",display:"display",id:"id",is_rts:"RTS",is_specific:"specific",owner_member_display_name:"owner",product_type:"type",smart_edit:"smart edit",attributes:"attributes",keywords:"keywords",price:"price",payment_methods:"payment methods",min_order_quantity:"MOQ(min. order quantity)",day:"day",unit_type:"unit type",gmt_create:"date create",gmt_modified:"date modified",score:"score",tag:"tag",customInfo:"custom info"},tableToolbar:{menuHide:"hide menu",menuShow:"show menu",productScore:"scores",productDisplayOn:"in-stock",productDisplayOff:"out-stock",productUpdate:"update",productEdit:"edit",productCopy:"copy"},form:{KeyInformation:"key information",ProductAttributes:"product attributes",productService:"product service",subject:"128 letters max.",category:"click to change category",keywords:"3 keywords max. Comma(,) separated",price:"set price (range)",payment_methods:"payment methods such as T/T, L/C, etc.",min_order_quantity:"optional",attributes:"add or delete",attributeMissing:"attribute missing",attributeDuplicated:"attribute duplicated",pleaseSelect:"please select",selectOrInput:"select or input",pieces:"pieces"},steps:{first:"Edit Attributes",second:"Edit Contents",finally:"Preview & Publish",previous:"Previous",next:"Next",complete:"Complete",addProduct:"Add Product",uneditable:"product is currently uneditable",productIdError:"product id error, pls go back & try again",categoryError:"category error, pls try again",editPrice:"Edit Price",editPeriod:"Edit Shipping Period",editAll:"Edit All",editDone:"Edit Done",nullNotAllowed:"empty value is not allowed",MOQError:"MOQ should be greater than the previous one",PriceError:"price should be smaller than the previous one",add:"Add",remove:"Remove",cloud:"Cloud",selectFromCloud:"Select from Cloud",choosePhotos:"Choose Photos",uploadPhotos:"Upload Photos",removePhotos:"double click to remove the photo",productDescriptionTip:"Tips: \u2460 If it cannot be updated, please remove ALL contents and try again. \u2461Click the red button below \ud83d\udc47 to unlock photo resizing",mainPhotoRequired:"Need at least one photo",descriptionOverflow:"description length shall be smaller than 60k letters",panel1:"subject, keywords, price, MOQ...",panel2:"all kinds of attributes...",panel3:"additional information...",addAttributes:"Add Attributes",clearAttributes:"Clear Attributes",modificationNull:"No modification made",addCustomInfo:"Add Custom Info",clearCustomInfo:"Clear Custom Info",modificationDone:"Will submit the following modifications:",numberOnly:"Please input number only",addSuccess:"Product added successfully",updateSuccess:"Product updated successfully",duplicateSuccess:"product duplicated successfully",uploadSuccess:"Upload Success",productScoreError:"no score found"},productScore:{basic:"Basic",potential:"Potential",super:"Super",top:"Top"},common:{yes:"OK",no:"Cancel",success:"Success",netFail:"request failed"}},zhCN:{folder:{currentFolder:"\u8bf7\u9009\u62e9",needFolderName:"\u8bf7\u586b\u5199\u6587\u4ef6\u5939\u540d",addNewFolder:"\u65b0\u5efa\u6587\u4ef6\u5939",folderNull:"\u6587\u4ef6\u5939\u4e0d\u5b58\u5728",dataNull:"\u6570\u636e\u4e0d\u5b58\u5728",folderRequired:"\u8bf7\u9009\u62e9\u6587\u4ef6\u5939"},table:{tableHeader:"\u4ea7\u54c1",categoryName:"\u7c7b\u76ee",productId:"\u4ea7\u54c1 id",subject:"\u6807\u9898",status:"\u5ba1\u6838\u72b6\u6001",display:"\u4e0a\u67b6\u72b6\u6001",id:"id",is_rts:"RTS",is_specific:"\u89c4\u683c\u54c1",owner_member_display_name:"\u8d1f\u8d23\u4eba",product_type:"\u5546\u54c1\u7c7b\u578b",smart_edit:"\u667a\u80fd\u7f16\u8f91",attributes:"\u5c5e\u6027",keywords:"\u5173\u952e\u8bcd",price:"\u4ef7\u683c",payment_methods:"\u652f\u4ed8\u65b9\u5f0f",min_order_quantity:"\u6700\u5c0f\u8d77\u8ba2\u91cf(MOQ)",day:"\u5929",unit_type:"\u5355\u4f4d",gmt_create:"\u521b\u5efa\u65e5\u671f",gmt_modified:"\u4fee\u6539\u65e5\u671f",score:"\u4ea7\u54c1\u5206",tag:"\u6807\u7b7e",customInfo:"\u5b9a\u5236\u4fe1\u606f"},tableToolbar:{menuHide:"\u9690\u85cf\u83dc\u5355",menuShow:"\u663e\u793a\u83dc\u5355",productScore:"\u4ea7\u54c1\u5206",productDisplayOn:"\u4e0a\u67b6",productDisplayOff:"\u4e0b\u67b6",productUpdate:"\u66f4\u65b0",productEdit:"\u7f16\u8f91",productCopy:"\u590d\u5236"},form:{KeyInformation:"\u57fa\u672c\u4fe1\u606f",ProductAttributes:"\u4ea7\u54c1\u5c5e\u6027",productService:"\u4ea7\u54c1\u670d\u52a1",subject:"128 \u5b57\u7b26\u4ee5\u5185",category:"\u70b9\u51fb\u66f4\u6362\u7c7b\u76ee",keywords:"\u6700\u591a\u4e09\u4e2a\u5173\u952e\u8bcd\uff0c\u7528\u82f1\u6587\u9017\u53f7(,)\u5206\u9694",price:"\u8bbe\u7f6e\u4ef7\u683c(\u533a\u95f4)",payment_methods:"\u652f\u4ed8\u65b9\u5f0f\uff0c\u4f8b\u5982\uff1aT/T\uff0cL/C\uff0c\u7b49",min_order_quantity:"\u9009\u586b",attributes:"\u53ef\u589e\u53ef\u51cf",attributeMissing:"\u5c5e\u6027\u7f3a\u5931",attributeDuplicated:"\u5c5e\u6027\u91cd\u590d",pleaseSelect:"\u8bf7\u9009\u62e9",selectOrInput:"\u9009\u62e9\u6216\u8f93\u5165",pieces:"\u4ef6"},steps:{first:"\u5c5e\u6027\u7f16\u8f91",second:"\u8be6\u60c5\u7f16\u8f91",finally:"\u9884\u89c8&\u53d1\u5e03",previous:"\u4e0a\u4e00\u6b65",next:"\u4e0b\u4e00\u6b65",complete:"\u5b8c\u6210",addProduct:"\u53d1\u5e03\u4ea7\u54c1",uneditable:"\u5f53\u524d\u4ea7\u54c1\u4e0d\u53ef\u7f16\u8f91",productIdError:"\u4ea7\u54c1 id \u9519\u8bef\uff0c\u8bf7\u8fd4\u56de\u91cd\u8bd5",categoryError:"\u7c7b\u76ee\u6709\u8bef\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9",editPrice:"\u7f16\u8f91\u4ef7\u683c",editPeriod:"\u7f16\u8f91\u53d1\u8d27\u671f",editAll:"\u7f16\u8f91\u5168\u90e8",editDone:"\u7f16\u8f91\u5b8c\u6210",nullNotAllowed:"\u4e0d\u80fd\u4e3a\u7a7a",MOQError:"MOQ\u503c\u987b\u5927\u4e8e\u524d\u4e00\u4e2a\u503c",PriceError:"\u4ef7\u683c\u503c\u987b\u5c0f\u4e8e\u524d\u4e00\u4e2a\u503c",add:"\u6dfb\u52a0",remove:"\u5220\u9664",cloud:"\u56fe\u5e93",selectFromCloud:"\u4ece\u4e91\u7aef\u9009\u62e9",choosePhotos:"\u9009\u62e9\u56fe\u7247",uploadPhotos:"\u4e0a\u4f20\u56fe\u7247",removePhotos:"\u53cc\u51fb\u79fb\u9664\u56fe\u7247",productDescriptionTip:"\u63d0\u793a: \u2460\u82e5\u65e0\u6cd5\u66f4\u65b0\uff0c\u8bf7\u6e05\u9664\u6240\u6709\u8be6\u60c5\u540e\u91cd\u8bd5 \u2461\u539f\u5148\u662f\u667a\u80fd\u7f16\u8f91\u7684\u60c5\u51b5\u4e0b\uff0c\u987b\u70b9\u51fb\u4e0b\u65b9\u7ea2\u8272\u6309\u94ae\u89e3\u9501\u56fe\u7247\u7f29\u653e\ud83d\udc47",mainPhotoRequired:"\u9700\u8981\u4fdd\u7559\u81f3\u5c11\u4e00\u5f20\u4e3b\u56fe",descriptionOverflow:"\u63cf\u8ff0\u957f\u5ea6\u4e0d\u80fd\u8d85\u8fc76\u4e07\u5b57\u7b26",panel1:"\u6807\u9898\uff0c\u5173\u952e\u8bcd\uff0c\u4ef7\u683c\uff0cMOQ...",panel2:"\u5404\u7c7b\u5c5e\u6027...",panel3:"\u9644\u52a0\u4fe1\u606f...",addAttributes:"\u6dfb\u52a0\u5c5e\u6027",clearAttributes:"\u79fb\u9664\u7a7a\u767d\u5c5e\u6027",addCustomInfo:"\u6dfb\u52a0\u81ea\u5b9a\u4e49\u4fe1\u606f",clearCustomInfo:"\u6e05\u7406\u81ea\u5b9a\u4e49\u4fe1\u606f",modificationNull:"\u6ca1\u6709\u4efb\u4f55\u4fee\u6539",modificationDone:"\u5c06\u63d0\u4ea4\u5982\u4e0b\u5185\u5bb9:",numberOnly:"\u8bf7\u8f93\u5165\u6570\u5b57",uploadSuccess:"\u4e0a\u4f20\u6210\u529f",addSuccess:"\u4ea7\u54c1\u6dfb\u52a0\u6210\u529f",updateSuccess:"\u4ea7\u54c1\u66f4\u65b0\u6210\u529f",duplicateSuccess:"\u4ea7\u54c1\u590d\u5236\u6210\u529f",productScoreError:"\u4ea7\u54c1\u5206\u672a\u67e5\u5230"},productScore:{basic:"\u4f4e\u8d28\u54c1",potential:"\u666e\u901a\u54c1",super:"\u5b9e\u529b\u4f18\u54c1",top:"\u7cbe\u54c1"},common:{yes:"\u786e\u5b9a",no:"\u53d6\u6d88",success:"\u64cd\u4f5c\u6210\u529f",netFail:"\u8bf7\u6c42\u5931\u8d25"}}}},322:function(e,t,n){"use strict";var r=n(16),a=n(85),l=n(278),c=n(388),i=n(201),o=n(282),u=n(320),s=n(321),d=n(1);t.a=function(e){var t=e.langPack,n=e.productModified,p=e.modificationSubmission,f=Object(r.f)(),j=Object.keys(n);return Object(d.jsxs)(d.Fragment,{children:[j.length?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)(a.a,{variant:"h3",children:t.steps.modificationDone}),Object(d.jsx)(l.a,{children:j.map((function(e){return Object(d.jsxs)(c.a,{children:["--",e]},e)}))})]}):Object(d.jsx)(a.a,{variant:"h3",children:t.steps.modificationNull}),Object(d.jsx)("br",{}),Object(d.jsx)(i.a,{}),Object(d.jsxs)("div",{align:"right",children:[Object(d.jsx)(o.a,{startIcon:Object(d.jsx)(u.a,{}),onClick:p,children:t.common.yes}),Object(d.jsx)(o.a,{startIcon:Object(d.jsx)(s.a,{}),onClick:function(){return f("/product")},children:t.common.no})]})]})}},433:function(e,t,n){"use strict";n.r(t);var r=n(35),a=n.n(r),l=n(3),c=n(7),i=n(54),o=n(12),u=n(0),s=n(22),d=n(16),p=n(250),f=n(443),j=n(458),b=n(85),m=n(459),v=n(382),h=n(23),x=n(87),O=n(312),y=n(441),g=n(448),_=n(435),S=n(357),k=n(282),C=n(272),q=n(1);var A=function(e){var t=e.langPack,n=e.activeStep,r=e.setActiveStep,a=Object(u.useState)([t.steps.first,t.steps.second,t.steps.finally]),l=Object(o.a)(a,1)[0];return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(y.a,{activeStep:n,children:l.map((function(e){return Object(q.jsx)(g.a,{children:Object(q.jsx)(_.a,{children:e})},e)}))}),Object(q.jsxs)(S.a,{variant:"contained",color:"secondary",disableElevation:!0,sx:{display:"flex",flexDirection:"row",pt:2,paddingBottom:"10px"},children:[Object(q.jsx)(k.a,{disabled:0===n,onClick:function(){r((function(e){return e-1}))},sx:{mr:1},children:t.steps.previous}),Object(q.jsx)(C.a,{sx:{flex:"1 1 auto"}}),Object(q.jsx)(k.a,{disabled:2===n,onClick:function(){r((function(e){return e+1}))},children:n===l.length-1?t.steps.complete:t.steps.next})]})]})},w=n(17),M=n(51),P=n(449),I=n(450),T=n(451),F=n(444),E=n(277),D=n(452),N=n(453),R=n(422),L=n(423),H=n(424),Q=Object(M.a)(Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,431))})));var z,V,B,G,U=function(e){var t=e.xmlSchema,n=e.onModified,r=e.photoCols,a=e.rowHeight,l=e.xmlGetField,i=e.langPack,s=Object(u.useState)({}),d=Object(o.a)(s,2),p=d[0],f=d[1],j=Object(u.useState)([]),b=Object(o.a)(j,2),m=b[0],v=b[1],h=Object(u.useState)(!1),x=Object(o.a)(h,2),O=x[0],y=x[1];function g(e,t){if(t.length){var r=Object(c.a)({},p),a=r._values||[],l=[];if("add"===e)(l=[].concat(Object(w.a)(a),Object(w.a)(t))).length>6&&(l.length=6);else if("remove"===e){if(a.length<=1)return queryResult(!1,i.steps.mainPhotoRequired);t.forEach((function(e){l=a.filter((function(t){return t.value!==e.value}))}))}else"reorder"===e&&(l=t);(l=(l=l.map((function(e,t){return Object(c.a)(Object(c.a)({},e),{},{key:"scImages_".concat(t),value:e.value.replace("https:","")})}))).filter((function(e){return e.id}))).length||y(!0),r._values=l;var o="complex-value",u=f,s=(new DOMParser).parseFromString(r.xml.outerHTML,"text/xml").firstChild.querySelectorAll("fields > field"),d="<".concat(o,">");l.forEach((function(e,t){s[t].innerHTML='<value fileId="'.concat(e.id,'">').concat(e.value,"</value>"),d+=s[t].outerHTML})),d+="</".concat(o,">"),r.values&&r.xml.querySelector(o).remove();var j=(new DOMParser).parseFromString(d,"text/xml").firstChild;return r.xml.append(j),u(r),n("scImages",r)}}Object(u.useEffect)((function(){t&&function(){var e=l("scImages");if(console.log(e),!e)return;e.values&&(e._values=e.values.map((function(e){return{key:e.id,value:e.values[0].value.replace(/_.*/,"")}})).sort((function(e,t){return Number(/\d/.exec(e.key)[0])-Number(/\d/.exec(t.key)[0])})));f(e)}()}),[t]);var _=function(e){return y(!1),e?g("add",m.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{key:e.id,value:e.url})}))):v([])};return Object(q.jsxs)(P.a,{cols:r,rowHeight:a,sx:{marginTop:"10px",marginBottom:"10px"},variant:"quilted",gap:2,children:[p._values&&p._values.length?p._values.map((function(e,t){return Object(q.jsxs)(I.a,{cols:1,rows:1,children:[Object(q.jsx)("img",{src:"https:"+e.value,alt:t+1,loading:"lazy"}),Object(q.jsx)(T.a,{sx:{background:"linear-gradient(to bottom, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 50%, rgba(0,0,0,0) 100%)"},title:t+1,position:"top",actionIcon:Object(q.jsx)(F.a,{title:i.steps.removePhotos,children:Object(q.jsx)(E.a,{sx:{color:t?"yellow":"white"},"aria-label":"star ".concat(t+1),onDoubleClick:function(){return g("remove",[e])},children:Object(q.jsx)(R.a,{})})}),actionPosition:"left"}),t&&e.id?Object(q.jsx)(k.a,{sx:{position:"absolute",right:"0px",top:"5px"},size:"large",color:"warning",onClick:function(){return function(e){var t=Object(c.a)({},p)._values,n=t.splice(e,1);return t.splice(e-1,0,n[0]),g("reorder",t)}(t)},startIcon:Object(q.jsx)(L.a,{})}):null]},t)})):Object(q.jsx)(q.Fragment,{}),!p._values||p._values.length<6?Object(q.jsxs)("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center"},children:[Object(q.jsx)(F.a,{title:i.steps.selectFromCloud,children:Object(q.jsx)(k.a,{sx:{height:"100%"},startIcon:Object(q.jsx)(H.a,{}),onClick:function(){return y(!0)},children:i.steps.cloud})}),Object(q.jsxs)(D.a,{onClose:function(){return _(!0)},open:O,children:[Object(q.jsx)(N.a,{children:i.steps.selectFromCloud}),Object(q.jsx)(Q,{onPhotoSelected:function(e){e&&v(e)}}),Object(q.jsx)(k.a,{variant:"contained",color:"primary",onClick:function(){return _(!0)},children:i.common.yes}),Object(q.jsx)(k.a,{variant:"contained",color:"error",onClick:function(){return _()},children:i.common.no})]})]}):null]})},K=n(262),W=n(440),Y=n(268),J=n(437),X=n(275),Z=n(454),$=n(455),ee=n(456),te=n(445),ne=n(457),re=n(320),ae=n(375),le=n(374),ce=n(425);var ie,oe=function(e){var t=e.xmlSchema,n=e.langPack,r=e.xmlGetField,a=e.onModified;console.log("core running");var l=Object(u.useState)({}),i=Object(o.a)(l,2),s=i[0],d=i[1],p=Object(u.useState)({}),f=Object(o.a)(p,2),j=f[0],m=f[1],v=Object(u.useState)({}),h=Object(o.a)(v,2),x=h[0],O=h[1],y=Object(u.useState)({}),g=Object(o.a)(y,2),_=g[0],S=g[1],C=Object(u.useState)({}),A=Object(o.a)(C,2),M=A[0],P=A[1],I=Object(u.useState)({}),T=Object(o.a)(I,2),E=T[0],D=T[1],N=Object(u.useState)(!1),R=Object(o.a)(N,2),L=R[0],H=R[1],Q=Object(u.useState)({}),U=Object(o.a)(Q,2),ie=U[0],oe=U[1],ue=Object(u.useState)(!1),se=Object(o.a)(ue,2),de=se[0],pe=se[1],fe=Object(u.useState)({}),je=Object(o.a)(fe,2),be=je[0],me=je[1],ve=Object(u.useState)({}),he=Object(o.a)(ve,2),xe=he[0],Oe=he[1];function ye(e){if(!e)return queryResult(!1,"\u8bf7\u8f93\u5165\u8d77\u8ba2\u91cf");var t=Object(c.a)({},M);e=Number(e),t._values={value:e};var n="value",r=P,l="<".concat(n,">");l+=e,l+="</".concat(n,">"),t.values&&t.xml.querySelector(n).remove();var i=(new DOMParser).parseFromString(l,"text/xml").firstChild;return t.xml.append(i),r(t),a("minOrderQuantity",t)}Object(u.useEffect)((function(){t&&(function(){var e=r("productTitle");if(console.log(e),!e)return;e.values&&(e._values={value:e.values[0].value});d(e)}(),function(){var e=r("productKeywords");if(console.log(e),!e)return;e.values&&(e._values={value:e.values.map((function(e){return e.values[0].value})).join(",")});m(e)}(),function(){var e=r("minOrderQuantity");if(console.log(e),!e)return;e.values&&(e._values={value:Number(e.values[0].value)});P(e)}(),function(){var e=r("paymentMethod");if(console.log(e),!e)return;e.values&&(e._values=e.values[0].values.map((function(e){return{value:e.value}})));e._options=e.options?e.options[0].options.map((function(e){return{key:e.displayName,value:e.value}})):[],O(e)}(),function(){var e=r("ladderPrice");if(console.log(e),!e)return;e.values?e._values=e.values.filter((function(e){return"complex"===e.type})).map((function(e){return{quantity:Number(e.values[0].values[0].value),price:Number(e.values[1].values[0].value)}})).sort((function(e,t){return e.quantity-t.quantity})):e._values=[{quantity:1,price:0}];D(e)}(),ge(),function(){var e=r("ladderPeriod");if(console.log(e),!e)return;e.values?e._values=e.values.filter((function(e){return"complex"===e.type})).map((function(e){return{quantity:Number(e.values[0].values[0].value),day:Number(e.values[1].values[0].value)}})).sort((function(e,t){return e.quantity-t.quantity})):e._values=[{quantity:1,price:0}];oe(e)}(),function(){var e=r("port");if(console.log(e),!e)return;e.values&&(e._values={value:e.values[0].value});me(e)}(),function(){var e=r("logisticsMode");if(console.log(e),!e)return;e._options=e.options?e.options.map((function(e){return{key:e.displayName,value:e.value}})):[],e.values&&(e._values=e.values.map((function(t){var n=t.value,r=e._options.find((function(e){return e.value===n})).key;return{key:r,value:n}})));Oe(e)}())}),[t]);var ge=function(){var e=r("priceUnit");if(console.log(e),e)return e._options=e.options?e.options.map((function(e){return{key:e.displayName,value:e.value}})):[],e.values&&(e._values={key:"",value:e.values[0].value},e._values.key=e._options.find((function(t){return t.value===e._values.value})).key),S(e)},_e=function(e,t){B||(B={}),B[e]=Number(t)},Se=function(e,t){var r=Object(c.a)({},E),l=r._values;if("add"===e){if(!l[l.length-1].price||l.length>=4)return;l=[].concat(Object(w.a)(l),[{quantity:"",price:""}])}else if("edit"===e){if(!B)return;if(!B.price||!B.quantity)return queryResult(!1,n.steps.nullNotAllowed);if(1!==l.length){if(B.quantity<=l[l.length-2].quantity)return queryResult(!1,n.steps.MOQError);if(B.price>=l[l.length-2].price)return queryResult(!1,n.steps.PriceError)}l.pop(),l=[].concat(Object(w.a)(l),[B]),B=""}else if("remove"===e){if(l.length<=1)return;l.splice(t,1)}r._values=l;var i=D;if("add"===e)return i(r);if((l=l.filter((function(e){return e.price}))).length){var o="complex-value",u=(new DOMParser).parseFromString(r.xml.outerHTML,"text/xml").firstChild.querySelectorAll("fields > field[type=complex]"),s="<".concat(o,">");l.forEach((function(e,t){u[t].querySelector("fields > field#quantity").innerHTML="<value>".concat(e.quantity,"</value>"),u[t].querySelector("fields > field#price").innerHTML="<value>".concat(e.price,"</value>"),s+=u[t].outerHTML})),s=(s+="</".concat(o,">")).replace(/fields/g,o),r.values&&r.xml.querySelector(o).remove();var d=(new DOMParser).parseFromString(s,"text/xml").firstChild;return r.xml.append(d),i(r),ye(l[0].quantity),a("ladderPrice",r)}},ke=function(e,t){G||(G={}),G[e]=Number(t)},Ce=function(e,t){var r=Object(c.a)({},ie),l=r._values;if("add"===e){if(!l[l.length-1].day||l.length>=3)return;l=[].concat(Object(w.a)(l),[{quantity:"",day:""}])}else if("edit"===e){if(!G)return;if(!G.day||!G.quantity)return queryResult(!1,n.steps.nullNotAllowed);l.pop(),l=[].concat(Object(w.a)(l),[G]),G=""}else if("remove"===e){if(l.length<=1)return;l.splice(t,1)}r._values=l;var i=oe;if("add"===e)return i(r);if((l=l.filter((function(e){return e.day}))).length){var o="complex-value",u=(new DOMParser).parseFromString(r.xml.outerHTML,"text/xml").firstChild.querySelectorAll("fields > field[type=complex]"),s="<".concat(o,">");l.forEach((function(e,t){u[t].querySelector("fields > field#quantity").innerHTML="<value>".concat(e.quantity,"</value>"),u[t].querySelector("fields > field#day").innerHTML="<value>".concat(e.day,"</value>"),s+=u[t].outerHTML})),s=(s+="</".concat(o,">")).replace(/fields/g,o),r.values&&r.xml.querySelector(o).remove();var d=(new DOMParser).parseFromString(s,"text/xml").firstChild;return r.xml.append(d),i(r),a("ladderPeriod",r)}};return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(F.a,{title:n.form.subject,children:Object(q.jsx)(K.a,{margin:"normal",fullWidth:!0,id:"productTitle",variant:"outlined",label:Object(q.jsx)(b.a,{variant:"h3",children:s.name}),defaultValue:s._values?s._values.value:"",onBlur:function(e){var t=e.target.value;if(!t||!t.trim())return queryResult(!1,"\u8bf7\u8f93\u5165\u4ea7\u54c1\u540d\u79f0");var n=Object(c.a)({},s);n._values={value:t};var r="value",l=d,i="<".concat(r,">");i+=t,i+="</".concat(r,">"),n.values&&n.xml.querySelector(r).remove();var o=(new DOMParser).parseFromString(i,"text/xml").firstChild;return n.xml.append(o),l(n),a("productTitle",n)}},s._values)}),Object(q.jsx)(F.a,{title:n.form.keywords,children:Object(q.jsx)(K.a,{margin:"normal",fullWidth:!0,id:"keywords",variant:"outlined",label:Object(q.jsx)(b.a,{variant:"h3",children:j.name}),defaultValue:j._values?j._values.value:"",onBlur:function(e){var t=e.target.value;if(!t||!t.trim())return queryResult(!1,"\u8bf7\u8f93\u5165\u5173\u952e\u8bcd");var r=t.split(",");r.length>3&&(r.length=3,queryResult(!1,n.form.keywords)),t=r.join(",");var l=Object(c.a)({},j);l._values={value:t};var i="complex-value",o=m,u=(new DOMParser).parseFromString(l.xml.outerHTML,"text/xml").firstChild.querySelectorAll("fields > field"),s="<".concat(i,">");r.forEach((function(e,t){u[t].innerHTML="<value>".concat(e,"</value>"),s+=u[t].outerHTML})),s+="</".concat(i,">"),l.values&&l.xml.querySelector(i).remove();var d=(new DOMParser).parseFromString(s,"text/xml").firstChild;return l.xml.append(d),o(l),a("productKeywords",l)}},j._values)}),Object(q.jsx)(W.a,{id:"add-payment-method",sx:{display:"inline"},multiple:!0,limitTags:1,disableCloseOnSelect:!0,onBlur:function(){if(z){if(!z.length)return queryResult(!1,"\u8bf7\u9009\u62e9\u4ed8\u6b3e\u65b9\u5f0f");var e=Object(c.a)({},x);e=Object(c.a)(Object(c.a)({},e),{},{_values:z});var t="complex-value",n=O,r=(new DOMParser).parseFromString(e.xml.outerHTML,"text/xml").firstChild.querySelectorAll("fields > field"),l="<".concat(t,">"),i=r[0],o="<values>";z.forEach((function(e){o+="<value>".concat(e.value,"</value>")})),o+="</values>",i.innerHTML=o,l+=i.outerHTML,z="",l+="</".concat(t,">"),e.values&&e.xml.querySelector(t).remove();var u=(new DOMParser).parseFromString(l,"text/xml").firstChild;return e.xml.append(u),n(e),a("paymentMethod",e)}},onChange:function(e,t){z=t},defaultValue:x._values,options:x._options||[],getOptionLabel:function(e){return e.key},isOptionEqualToValue:function(e,t){return e.value===t.value},renderTags:function(e,t){return e.map((function(e,n){return Object(q.jsx)(Y.a,Object(c.a)({variant:"outlined",label:e.value},t({index:n})))}))},renderOption:function(e,t,n){var r=n.selected;return Object(q.jsxs)("li",Object(c.a)(Object(c.a)({},e),{},{children:[Object(q.jsx)(J.a,{style:{marginRight:8},checked:r}),t.value]}))},renderInput:function(e){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},e),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:x.name}),placeholder:n.form.selectOrInput}))}},x._values),Object(q.jsx)(W.a,{id:"add-price-unit",sx:{display:"inline"},onChange:function(e,t){return function(e){if(!e)return queryResult(!1,"\u8bf7\u8f93\u5165\u8ba1\u91cf\u5355\u4f4d");var t=Object(c.a)({},_);t._values=e;var n="value",r=S,l="<".concat(n,">");l+=e.value,l+="</".concat(n,">"),t.values&&t.xml.querySelector(n).remove();var i=(new DOMParser).parseFromString(l,"text/xml").firstChild;return t.xml.append(i),r(t),a("priceUnit",t)}(t)},defaultValue:_._values,options:_._options||[],getOptionLabel:function(e){return e.key},isOptionEqualToValue:function(e,t){return e.value===t.value},renderOption:function(e,t,n){var r=n.selected;return Object(q.jsxs)("li",Object(c.a)(Object(c.a)({},e),{},{children:[Object(q.jsx)(J.a,{style:{marginRight:8},checked:r}),t.key]}))},renderInput:function(e){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},e),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:_.name}),placeholder:n.form.selectOrInput}))}},_._values?_._values.value:""),Object(q.jsx)(F.a,{title:n.form.min_order_quantity,children:Object(q.jsx)(K.a,{disabled:!0,type:"number",sx:{maxWidth:"280px"},margin:"normal",id:"min_order_quantity",variant:"outlined",label:Object(q.jsx)(b.a,{variant:"h3",children:M.name}),value:E._values?E._values[0].quantity:M._values?M._values.value:"",InputProps:{endAdornment:Object(q.jsx)(X.a,{position:"end",children:_._values?_._values.key:n.form.pieces})},onBlur:function(e){return ye(e.target.value)}},E._values)}),Object(q.jsx)("br",{}),Object(q.jsx)(F.a,{title:n.form.subject,children:Object(q.jsx)(K.a,{margin:"normal",id:"port",variant:"outlined",label:Object(q.jsx)(b.a,{variant:"h3",children:be.name}),defaultValue:be._values?be._values.value:"",onBlur:function(e){var t=e.target.value;if(!t||!t.trim())return queryResult(!1,"\u8bf7\u8f93\u5165\u6d77\u8fd0\u6e2f\u53e3");var n=Object(c.a)({},be);n._values={value:t};var r="value",l=me,i="<".concat(r,">");i+=t,i+="</".concat(r,">"),n.values&&n.xml.querySelector(r).remove();var o=(new DOMParser).parseFromString(i,"text/xml").firstChild;return n.xml.append(o),l(n),a("port",n)}},be._values)}),Object(q.jsx)(W.a,{id:"change-logistics-mode",multiple:!0,disableCloseOnSelect:!0,sx:{display:"inline"},onBlur:function(){if(V){if(!V.length)return queryResult(!1,"\u8bf7\u9009\u62e9\u7269\u6d41\u6a21\u5f0f");var e=Object(c.a)({},xe),t="values",n=Oe,r="<".concat(t,">"),l="";(V=V.map((function(t){var n=e._options.find((function(e){return e.key===t})).value;return{key:t,value:n}}))).forEach((function(e){l+="<value>".concat(e.value,"</value>")})),r+=l+"</".concat(t,">"),e=Object(c.a)(Object(c.a)({},e),{},{_values:V}),V="",e.values&&e.xml.querySelector(t).remove();var i=(new DOMParser).parseFromString(r,"text/xml").firstChild;return e.xml.append(i),n(e),a("logisticsMode",e)}},onChange:function(e,t){V=t},defaultValue:xe._values?xe._values.map((function(e){return e.key})):[],options:xe._options?xe._options.map((function(e){return e.key})):[],renderTags:function(e,t){return e.map((function(e,n){return Object(q.jsx)(Y.a,Object(c.a)({variant:"outlined",label:e},t({index:n})))}))},renderOption:function(e,t,n){var r=n.selected;return Object(q.jsxs)("li",Object(c.a)(Object(c.a)({},e),{},{children:[Object(q.jsx)(J.a,{style:{marginRight:8},checked:r}),t]}))},renderInput:function(e){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},e),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:xe.name}),placeholder:n.form.selectOrInput}))}},JSON.stringify(xe._values)),Object(q.jsx)("hr",{}),Object(q.jsxs)(Z.a,{size:"small",children:[Object(q.jsx)($.a,{children:Object(q.jsxs)(ee.a,{children:[Object(q.jsx)(te.a,{children:n.table.min_order_quantity}),Object(q.jsx)(te.a,{children:n.table.price}),Object(q.jsx)(te.a,{children:Object(q.jsx)(k.a,{startIcon:L?Object(q.jsx)(re.a,{}):Object(q.jsx)(ae.a,{}),onClick:function(){if(L)Se("edit");else{var e=E._values,t=e[e.length-1];B=Object(c.a)({},t)}H((function(e){return!e}))},children:L?n.steps.editDone:n.steps.editPrice})})]})}),Object(q.jsx)(ne.a,{children:E&&E._values?E._values.map((function(e,t){return Object(q.jsxs)(ee.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(q.jsx)(te.a,{children:Object(q.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(q.jsx)(b.a,{sx:{display:"inline"},children:"\u2264"}),L&&t===E._values.length-1?Object(q.jsx)(K.a,{size:"small",variant:"outlined",type:"number",defaultValue:e.quantity,onBlur:function(e){return _e("quantity",e.target.value)}}):e.quantity,Object(q.jsxs)(b.a,{sx:{display:"inline"},children:["&nbsp;".encodeHTMLEntity()," ",_._values?_._values.key:""]})]})}),Object(q.jsx)(te.a,{component:"th",scope:"row",children:L&&t===E._values.length-1?Object(q.jsx)(K.a,{size:"small",variant:"outlined",type:"number",defaultValue:e.price,onBlur:function(e){return _e("price",e.target.value)}}):e.price}),Object(q.jsx)(te.a,{children:0===t?Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(le.a,{}),onClick:function(){return Se("add",t)},children:n.steps.add}):Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(ce.a,{}),onClick:function(){return Se("remove",t)},children:n.steps.remove})})]},t)})):Object(q.jsx)(q.Fragment,{})})]}),Object(q.jsx)("hr",{}),Object(q.jsxs)(Z.a,{size:"small",children:[Object(q.jsx)($.a,{children:Object(q.jsxs)(ee.a,{children:[Object(q.jsx)(te.a,{children:n.table.min_order_quantity}),Object(q.jsx)(te.a,{children:n.table.day}),Object(q.jsx)(te.a,{children:Object(q.jsx)(k.a,{startIcon:de?Object(q.jsx)(re.a,{}):Object(q.jsx)(ae.a,{}),onClick:function(){if(de)Ce("edit");else{var e=ie._values,t=e[e.length-1];G=Object(c.a)({},t)}pe((function(e){return!e}))},children:de?n.steps.editDone:n.steps.editPeriod})})]})}),Object(q.jsx)(ne.a,{children:ie&&ie._values?ie._values.map((function(e,t){return Object(q.jsxs)(ee.a,{sx:{"&:last-child td, &:last-child th":{border:0}},children:[Object(q.jsx)(te.a,{children:Object(q.jsxs)("div",{style:{display:"flex",flexDirection:"row",alignItems:"center"},children:[Object(q.jsx)(b.a,{sx:{display:"inline"},children:"\u2264"}),de&&t===ie._values.length-1?Object(q.jsx)(K.a,{size:"small",variant:"outlined",type:"number",defaultValue:e.quantity,onBlur:function(e){return ke("quantity",e.target.value)}}):e.quantity,Object(q.jsxs)(b.a,{sx:{display:"inline"},children:["&nbsp;".encodeHTMLEntity()," ",_._values?_._values.key:""]})]})}),Object(q.jsx)(te.a,{component:"th",scope:"row",children:de&&t===ie._values.length-1?Object(q.jsx)(K.a,{size:"small",variant:"outlined",type:"number",defaultValue:e.day,onBlur:function(e){return ke("day",e.target.value)}}):e.day}),Object(q.jsx)(te.a,{children:0===t?Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(le.a,{}),onClick:function(){return Ce("add",t)},children:n.steps.add}):Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(ce.a,{}),onClick:function(){return Ce("remove",t)},children:n.steps.remove})})]},t)})):Object(q.jsx)(q.Fragment,{})})]})]})},ue=n(201),se=n(321),de=n(376),pe={};var fe=function(e){var t=e.langPack,n=e.xmlSchema,r=e.xmlGetField,a=e.onModified;console.log("attributes running");var l=Object(u.useState)({}),i=Object(o.a)(l,2),s=i[0],d=i[1],p=Object(u.useState)(!1),f=Object(o.a)(p,2),j=f[0],m=f[1],v=Object(u.useState)(""),h=Object(o.a)(v,2),x=h[0],O=h[1];Object(u.useEffect)((function(){n&&(pe.attributeObj?d(pe.attributeObj):function(){var e=r("icbuCatProp");if(!e||e._values||e._options)return;e.values&&(e._values=e.values.filter((function(e){return e.name})).sort((function(e,t){return e.type.length-t.type.length})),e._values=y(e._values));e.options&&(e._options=e.options.filter((function(e){return e.name})).sort((function(e,t){return e.type.length-t.type.length})),e._options=g(e._options));console.log(e),d(e)}())}),[n]);var y=function e(t){if(!t||!t.length)return t;var n=[];return t.forEach((function(t){var r=Object(c.a)({},t),a=r,l=a.type,i=a.displayName,o=a.inputValue,u=a.value,s=a.values;if(void 0!==u){var d={};void 0!==i&&(d.key=i),void 0!==o&&(d.key=o),void 0!==u&&(d.value=u),Object.keys(d).length&&(r=Object(c.a)(Object(c.a)({},r),d))}else if(["input","singleCheck"].find((function(e){return e===l}))){var p={};void 0!==s[0].inputValue&&(p.key=s[0].inputValue),void 0!==s[0].value&&(p.value=s[0].value),Object.keys(p).length&&(r._values=p)}else{var f=e(s);f&&(r._values=f)}n.push(r)})),n},g=function e(t){if(!t||!t.length)return t;var n=[];return t.forEach((function(t){var r=Object(c.a)({},t),a=r,l=a.type,i=a.options,o=a.displayName,u=a.inputValue,s=a.value;if(void 0!==s){var d={};void 0!==o&&(d.key=o),void 0!==u&&(d.key=u),void 0!==s&&(d.value=s),Object.keys(d).length&&(r=Object(c.a)(Object(c.a)({},r),d))}else if(/input/gi.test(l))r._options=!1;else{var p=e(i);if(p)r._options=p;else{var f={};i&&void 0!==i[0].displayName&&(f.key=i[0].displayName),i&&void 0!==i[0].value&&(f.value=i[0].value),Object.keys(f).length&&(r._options=[f])}}n.push(r)})),n};function _(e,t){var n=e._values,r=[],l=d,c="complex-value",i=(new DOMParser).parseFromString(e.xml.outerHTML,"text/xml").firstChild,o="<".concat(c,">");n.forEach((function(e,t){var n,a=e.type,l=e.id,c=e._values,u=i.querySelector("fields > field#".concat(l));if(u)if(u.innerHTML="",/multi(?!Complex)/.test(a)){var s="";c.forEach((function(e){var t=e.key,n=e.value;s+='<value inputValue="'.concat(t,'">').concat(n,"</value>")}));var d=document.createElement("values");d.innerHTML=s,s?(u.innerHTML=d.outerHTML,o+=u.outerHTML):r.push(t)}else{var p=c.key,f=c.value,j=document.createElement("value");j.setAttribute("inputValue",p),j.innerText=f;void 0!==(n=p)&&""!==String(n).trim()&&null!==n?(u.innerHTML=j.outerHTML,o+=u.outerHTML):r.push(t)}})),o+="</".concat(c,">"),r.length&&t&&(e._values=n.filter((function(e,t){return!r.find((function(e){return e===t}))}))),e.values&&e.xml.querySelector(c).remove();var u=(new DOMParser).parseFromString(o,"text/xml").firstChild;return e.xml.append(u),l(e),pe.attributeObj=e,a("icbuCatProp",e)}var S=function(){if(console.log("confirming"),!ie)return console.log("\u672a\u4fee\u6539\u4efb\u4f55\u5c5e\u6027\u5462");var e=ie,t=Object(o.a)(e,2),n=t[0],r=t[1],a=n.id,l=n.type,i=n._values,u=Object(c.a)({},s),d=u._values,p=s._options.find((function(e){return e.id===a}));if(/multi(?!Complex)/.test(l))i=[],r.forEach((function(e){if(p._options){var t=p._options.find((function(t){return t.key===e}));t?i.push(t):i.push({key:"",value:e})}else i.push({key:"",value:e})}));else if(p._options){var f=p._options.find((function(e){return e.key===r}));i=f||{key:r,value:""}}else i.key=r;n._values=i,(d=d.filter((function(e){return e.id!==a}))).push(n),u._values=d,_(u)},C=function(e,t){ie=[e,t]};return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("div",{style:{paddingTop:"10px",paddingBottom:"20px"},children:j?Object(q.jsx)(q.Fragment,{children:s._options&&s._options.length?Object(q.jsxs)("span",{style:{display:"flex",flexDirection:"row",alignItems:"stretch"},children:[Object(q.jsx)(W.a,{id:"attribute-options",sx:{display:"inline"},multiple:!0,disableCloseOnSelect:!0,onChange:function(e,t){O(t)},options:s._options.map((function(e){return e.name})),renderOption:function(e,t,n){var r=n.selected;return Object(q.jsxs)("li",Object(c.a)(Object(c.a)({},e),{},{children:[Object(q.jsx)(J.a,{style:{marginRight:8},checked:r}),t]}))},renderInput:function(e){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},e),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:s.name}),placeholder:t.form.selectOrInput}))}},s._options?s._options:"attribute-options"),Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(re.a,{}),onClick:function(){if(x){var e=x.map((function(e){return s._options.find((function(t){return t.name===e}))})),t=Object(c.a)({},s),n=t._values||[];e.forEach((function(e){if(!n.length||!n.find((function(t){return t.id===e.id}))){var t=e.id,r=e.name,a=e.type,l={id:t,name:r,type:a};l._values=/multi(?!Complex)/.test(a)?[]:{},n.push(l)}})),t._values=n,d(t),O(""),m((function(e){return!e}))}},children:t.common.yes}),Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(se.a,{}),onClick:function(){return m((function(e){return!e}))},children:t.common.no})]}):Object(q.jsx)(b.a,{variant:"body1",children:t.form.attributeMissing})}):Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(F.a,{title:t.steps.addAttributes,children:Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(le.a,{}),onClick:function(){return m((function(e){return!e}))},children:t.steps.addAttributes})}),Object(q.jsx)(F.a,{title:t.steps.clearAttributes,children:Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(de.a,{}),onClick:function(){return console.log("clearing"),_(Object(c.a)({},s),!0)},children:t.steps.clearAttributes})})]})}),Object(q.jsx)(ue.a,{}),Object(q.jsx)("br",{}),s._values&&s._values.length?s._values.map((function(e){return/input/gi.test(e.type)?Object(q.jsx)(K.a,{id:"current-attributes-input-only",fullWidth:!1,defaultValue:e._values.key||"",onBlur:S,onChange:function(t){return C(e,t.target.value)},sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:e.name+" _ "+e.type}),placeholder:t.form.selectOrInput},e.id+JSON.stringify(e._values)):/multi(?!Complex)/.test(e.type)?Object(q.jsx)(W.a,{id:"current-attributes-multiple",sx:{display:"inline"},limitTags:1,multiple:!0,disableCloseOnSelect:!0,onBlur:S,onChange:function(t,n){return C(e,n)},options:s._options.find((function(t){return t.id===e.id}))._options.map((function(e){return e.key})),defaultValue:e._values.map((function(e){return e.key})),renderTags:function(e,t){return e.map((function(e,n){return Object(q.jsx)(Y.a,Object(c.a)({variant:"outlined",label:e},t({index:n})))}))},renderOption:function(e,t,n){var r=n.selected;return Object(q.jsxs)("li",Object(c.a)(Object(c.a)({},e),{},{children:[Object(q.jsx)(J.a,{style:{marginRight:8},checked:r}),t]}))},renderInput:function(n){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},n),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:e.name+" _ "+e.type}),placeholder:t.form.selectOrInput}))}},e.id+JSON.stringify(e._values)):Object(q.jsx)(W.a,{id:"current-attributes-single",sx:{display:"inline"},onBlur:S,onChange:function(t,n){return C(e,n)},defaultValue:e._values.key,options:s._options.find((function(t){return t.id===e.id}))._options.map((function(e){return e.key})),renderInput:function(n){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},n),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:e.name+" _ "+e.type}),placeholder:t.form.selectOrInput}))}},e.id+JSON.stringify(e._values))})):Object(q.jsx)(q.Fragment,{})]})};var je=function(e){var t=e.langPack,n=e.onModified,r=e.xmlSchema,a=e.xmlGetField;console.log("service running");var l="",i=Object(u.useState)({}),s=Object(o.a)(i,2),d=s[0],p=s[1],f=Object(u.useState)(!1),j=Object(o.a)(f,2),m=j[0],v=j[1],h=Object(u.useState)(""),x=Object(o.a)(h,2),O=x[0],y=x[1];Object(u.useEffect)((function(){r&&function(){var e=a("customizedServices");if(!e)return;e.values&&(e._values=e.values.filter((function(e){return"complex"===e.type})).map((function(e){return{key:e.values[1].values[0].value,value:Number(e.values[0].values[0].value)}})));var t=e.options.filter((function(e){return"complex"===e.type}));t.length&&(e._options=t[0].options[1].options.filter((function(e){return"-1"!==e.value})).map((function(e){return Object(c.a)(Object(c.a)({},e),{},{key:e.displayName,value:e.value})})));console.log(e),p(e)}()}),[r]);var g=function(e){y(e)},_=function(){if(l){var e=Object(c.a)({},d),t=e._values.filter((function(e){return e.key!==l.key}));(t=(t=t.filter((function(e){return e.value}))).filter((function(e){return!isNaN(e.value)}))).push(l),l="",e._values=t;var r=p,a="complex-value",i=(new DOMParser).parseFromString(e.xml.outerHTML,"text/xml").firstChild.querySelectorAll("fields > field[type=complex]"),o="<".concat(a,">");t.forEach((function(e,t){i[t].querySelector("fields > field#custom_type").innerHTML="<value>".concat(e.key,"</value>"),i[t].querySelector("fields > field#quantity").innerHTML="<value>".concat(e.value,"</value>"),o+=i[t].outerHTML})),o=(o+="</".concat(a,">")).replace(/fields/g,a),e.values&&e.xml.querySelector(a).remove();var u=(new DOMParser).parseFromString(o,"text/xml").firstChild;e.xml.append(u),r(e),n("customizedServices",e)}};return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)("div",{style:{paddingTop:"10px",paddingBottom:"20px"},children:m?Object(q.jsxs)("span",{style:{display:"flex",flexDirection:"row",alignItems:"stretch"},children:[d._options&&d._options.length?Object(q.jsx)(W.a,{id:"add-custom",freeSolo:!0,sx:{display:"inline"},onChange:function(e,t){return g(t)},onInputChange:function(e,t){return g(t)},options:d._options.map((function(e){return e.key})),renderInput:function(e){return Object(q.jsx)(K.a,Object(c.a)(Object(c.a)({},e),{},{fullWidth:!1,sx:{marginTop:"13px",minWidth:"220px"},label:Object(q.jsx)(b.a,{variant:"h3",children:d.name}),placeholder:t.form.selectOrInput}))}},d._options||"options"):Object(q.jsx)(q.Fragment,{}),Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(re.a,{}),onClick:function(){return function(){if(O&&O.trim()){var e=Object(c.a)({},d),t=e._options.find((function(e){return e.key===O})),n=t?t.value:O;e._values||(e._values=[]);var r=e._values.filter((function(e){return e.key!==n}));if(r.length>=5)return queryResult(!1,"\u6700\u591a\u53ea\u80fd\u6dfb\u52a05\u4e2a\u5b9a\u5236\u5185\u5bb9");r.push({key:n,value:0}),e._values=r,p(e),console.log(e),y(""),v((function(e){return!e}))}}()},children:t.common.yes}),Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(se.a,{}),onClick:function(){return v((function(e){return!e}))},children:t.common.no})]}):Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(F.a,{title:t.steps.addCustomInfo,children:Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(le.a,{}),onClick:function(){return v((function(e){return!e}))},children:t.steps.addCustomInfo})}),Object(q.jsx)(F.a,{title:t.steps.clearCustomInfo,children:Object(q.jsx)(k.a,{startIcon:Object(q.jsx)(de.a,{}),onClick:function(){var e=Object(c.a)({},d);e._values=e._values.filter((function(e){return e.value})),p(e)},children:t.steps.clearCustomInfo})})]})}),Object(q.jsx)(ue.a,{}),Object(q.jsx)("br",{}),d._values&&d._values.length?d._values.map((function(e){return Object(q.jsx)(K.a,{fullWidth:!1,defaultValue:e.value,onChange:function(t){!function(e){l||(l={});var t=Number(e.value);isNaN(t)?queryResult(!1,"\u8bf7\u8f93\u5165\u6570\u5b57"):l={key:e.key,value:t}}({key:e.key,value:t.target.value})},onBlur:_,label:Object(q.jsx)(b.a,{variant:"h3",children:e.key}),placeholder:t.form.selectOrInput},e.key)})):Object(q.jsx)(q.Fragment,{})]})},be=n(383),me=n.n(be),ve=Object(M.a)(Object(u.lazy)((function(){return Promise.all([n.e(0),n.e(2)]).then(n.bind(null,431))})));var he,xe,Oe,ye=function(e){var t=e.localization,n=e.finalDescription,r=e.onModified,a=e.xmlSchema,l=e.xmlGetField,i=e.langPack,s=Object(u.useState)({}),d=Object(o.a)(s,2),p=d[0],f=d[1],j=Object(u.useState)({}),m=Object(o.a)(j,2),v=m[0],h=m[1],x=Object(u.useState)([]),O=Object(o.a)(x,2),y=O[0],g=O[1],_=Object(u.useState)(!1),S=Object(o.a)(_,2),C=S[0],A=S[1];function w(e){if(!e||!e.trim())return queryResult(!1,"\u8bf7\u8f93\u5165\u4ea7\u54c1\u8be6\u60c5");if(e===p._values.value)return console.log("\u672a\u4fee\u6539");e=e.replace(/\n/g,"").trim();var t=Object(c.a)({},p);t._values={value:e};var n=f,a=e.trim().encodeNonASCII();return a.length>5e4?queryResult(!1,i.form.descriptionOverflow):(t.xml.innerHTML="",t.xml.append(document.createElement("value")),t.xml.children[0].innerText=a,n(t),function(e){var t=Object(c.a)({},v);t._options.find((function(t){return t.value===e}))&&(t._values={key:t._options.find((function(t){return t.value===e})).key,value:e});var n="value",a=h,l="<".concat(n,">");l+=e,l+="</".concat(n,">"),t.xml.innerHTML=l.trim().encodeHTMLEntity(),a(t),r("productDescType",t)}("2"),r("superText",t))}Object(u.useEffect)((function(){a&&void 0!==n&&(function(){var e=l("superText");e._values={value:n},f(e)}(),function(){var e=l("productDescType");e._options=e.options?e.options.map((function(e){return{key:e.displayName,value:e.value}})):[];var t=e.values?e.values[0].value:"2";if(e._options.find((function(e){return e.value===t}))){var n=e._options.find((function(e){return e.value===t})).key;e._values={key:n,value:t}}console.log(e),h(e)}())}),[a,n]);var M=function(e){if(A(!1),e){var t=y.map((function(e){return Object(c.a)(Object(c.a)({},e),{},{key:e.id,value:e.url})}));return onImageChange("add",t)}return g([])},P=Object(u.useRef)(null),I={language:"zhCN"===t.locale?"zh_cn":"en_us",enter:"DIV",defaultActionOnPaste:"insert_clear_html",toolbarAdaptive:!1,buttons:["source","bold","italic","underline","eraser","ul","ol","left","font","fontsize","brush","image","copyformat","copy","paste","table","link",{iconURL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEwAAABMCAYAAADHl1ErAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAK/SURBVHhe7ZvhTcMwEIXZAEZgA9gANigbwAaMABuUDegGjAAbMAIjMIK5JxIp5OyzL02I3bxPej9aXdLzp8RO0/QsEBcU5oTCnFCYEwpzQmFOKMzJ/wj7+Kgnn59dU9NYTtjhEMLlpXyCfESNubsL4f29a7Yc2XIBHh50g7Xm9bVrugzZYmaennRTtcdxpEn1jHx/62ZayG7XDSCPVM8IDu9YQy2kkPLKElKn49VVCDc3deT8PN5j4eoplTOSEjZhNVoMSDuiR6mcEQpzQmFOKMzJ5oV9fYXw/KyTujrevDDsJLZzfGgMCqOwMVJpQGEKqTSgMIVUGlCYQioNKEwhlQYUppBKAwpTSKUBhSmk0oDCFFJpQGEKqTSgMIVUGlCYQioNaheGuyleNisMsi4uQtjvuzcK2aQw/P55fT1t/yclDI8YQEaO8aMIONJKT8+TEfb4+FsLGRY4Bcf7R3DElXASwt7e/tanboGn+umTkw2aF9ZP3sN6vB7/Eh2riyX3NE7zwoaT9zB4v5/PxpN8LtbP/k0L6+etVPpTbDzJ54IjMbV4NCtsPG+lgicFY+/nkloEmhRWOh8dm9gi0KQwz3x0bMaLQHPCMABs/58Zzmd4nevRQCoNlhC2NhTmpAlhLy/xPxmskdT8uYqw1Pe8FlKIXekVhivsWH3twUPLhUi1gVcYSM0RNSf3/XOAVBtMEYaL0tSj3TXm/r5rvAzZwmCKMABpLRxpWKScyFYGU4X1YE7DQoDGagpOwZI7uxFk9AbHCjtBZPQGFKaQ0RtQmEJGb0BhChm9AYUpZPQGqSt33Py7va07jotRDzL6DDFhLQSXDwsge86Av/fGGqo9qwlLzWO1ZzVhAPNBrKmas6owgCOtpdNzdWFDsHpCYM3BDYAFmCZsw1CYEwpzQmFOKMwJhTmhMCcU5oTCXITwA9i8QLpYTlc4AAAAAElFTkSuQmCC",tooltip:"Clear Image style",exec:function(e,t,n){var r=e.value,a=(r=(r=r.replace(/\n/gi,"")).replace(/>/gi,">\n")).split("\n");r=(a=a.map((function(e){return/<img src/gi.test(e)?e=/ class="magic-(\d{1,3})x000"/gi.test(e)?e.replace(/x000/gi,""):e.replace(/ class="magic-(\d{1,3})"/gi,' class="magic-$1x000"'):e}))).join(""),e.value=r}}],events:{paste:function(e){console.log("\u7c98\u8d34...",e);var t=e.clipboardData&&e.clipboardData.items;if(t&&t.length)return console.log(t)},beforePasteInsert:function(e){console.log("\u7c98\u8d34\u5185\u5bb9\u690d\u5165\u524d...")}}};return Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(b.a,{variant:"h4",sx:{paddingTop:"6px",paddingBottom:"6px",color:"orangered"},children:i.steps.productDescriptionTip}),Object(q.jsxs)("div",{style:{display:"none",flexDirection:"column",justifyContent:"center"},children:[Object(q.jsx)(F.a,{title:i.steps.selectFromCloud,children:Object(q.jsx)(k.a,{sx:{height:"100%"},startIcon:Object(q.jsx)(H.a,{}),onClick:function(){return A(!0)},children:i.steps.cloud})}),Object(q.jsxs)(D.a,{onClose:function(){return M(!0)},open:C,children:[Object(q.jsx)(N.a,{children:i.steps.selectFromCloud}),Object(q.jsx)(ve,{onPhotoSelected:function(e){e&&g(e)}}),Object(q.jsx)(k.a,{variant:"contained",color:"primary",onClick:function(){return M(!0)},children:i.common.yes}),Object(q.jsx)(k.a,{variant:"contained",color:"error",onClick:function(){return M()},children:i.common.no})]})]}),Object(q.jsx)(me.a,{ref:P,value:p._values?p._values.value:"",config:I,tabIndex:1,onBlur:function(e){return w(e)},onChange:function(e){}})]})},ge=n(322),_e={};t.default=function(){console.log("productEdit app running");var e=Object(s.c)((function(e){return e.localization})),t=Object(s.c)((function(e){return e.globalization})),n=Object(u.useState)(O.a[e.locale]),r=Object(o.a)(n,2),y=r[0],g=r[1],_=Object(u.useState)(t.baseData.loginData),S=Object(o.a)(_,1)[0],k=Object(d.f)(),C=Object(u.useState)(0),w=Object(o.a)(C,2),M=w[0],P=w[1],I=Object(u.useState)({panel1:!0,panel2:!0,panel3:!0,panel4:!0}),T=Object(o.a)(I,2),F=T[0],E=T[1],D=new URLSearchParams(location.pathname.replace("/product/","")),N=D.get("product_id"),R=D.get("category_id");he=N?"update":"add";var L=Object(u.useState)(null),H=Object(o.a)(L,2),Q=H[0],z=H[1],V=Object(u.useState)({}),B=Object(o.a)(V,2),G=B[0],K=B[1],W=Object(u.useState)(""),Y=Object(o.a)(W,2),J=Y[0],X=Y[1],Z=Object(u.useState)(0),$=Object(o.a)(Z,2),ee=$[0],te=$[1],ne=Object(p.a)(Object(h.a)().breakpoints.down("md"))?3:6;function re(){return(re=Object(i.a)(a.a.mark((function e(t){var n,r,l,c,i,o,u,s;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ma.productDetailQuery(t),e.next=3,fetchAPI(n);case 3:if((r=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,y.common.netFail+"\n"+r.response.result));case 6:if(l=ma.productDetailCheck(r),c=l.response,i=c.status,o=c.result,i){e.next=10;break}return e.abrupt("return",queryResult(i,o));case 10:console.log(o),u=o.description,s=o.category_id,u&&X(u),s&&te(s),N&&ae({product_id:N}),K(o);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ae(e){return le.apply(this,arguments)}function le(){return(le=Object(i.a)(a.a.mark((function e(t){var n,r,l,c,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ma.productIdQuery(t),e.next=3,fetchAPI(n);case 3:if((r=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,y.common.netFail+"\n"+r.response.result));case 6:if(l=ma.productIdCheck(r),c=l.response,i=c.status,o=c.result,i){e.next=10;break}return e.abrupt("return",queryResult(i,o));case 10:return ue({product_id:Oe=o}),e.abrupt("return",console.log(o));case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ce(){return(ce=Object(i.a)(a.a.mark((function e(t){var n,r,l,c,i,o;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return-1,n=ma.photoUploadQuery({file_name:t.name,image_bytes:t,group_id:-1}),e.next=4,fetchAPI(n);case 4:if((r=e.sent).response.status){e.next=7;break}return e.abrupt("return",queryResult(!1,y.common.yes));case 7:if(l=ma.photoUploadCheck(r),c=l.response,i=c.status,o=c.result,i){e.next=11;break}return e.abrupt("return",queryResult(!1,o));case 11:return queryResult(!0,y.steps.uploadSuccess),e.abrupt("return",o);case 13:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(){return(ie=Object(i.a)(a.a.mark((function e(t){var n,r,l,i,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ma.productSchemaQuery({param_product_top_publish_request:JSON.stringify(Object(c.a)(Object(c.a)({},t),{},{language:"zh"}))}),e.next=3,fetchAPI(n);case 3:if((r=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,y.common.netFail+"\n"+r.response.result));case 6:if(l=ma.productSchemaCheck(r),i=l.response,o=i.status,u=i.result,o){e.next=10;break}return e.abrupt("return",queryResult(o,u));case 10:return e.abrupt("return",de(u));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ue(e){return se.apply(this,arguments)}function se(){return(se=Object(i.a)(a.a.mark((function e(t){var n,r,l,i,o,u;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=ma.productSchemaRenderQuery({param_product_top_publish_request:JSON.stringify(Object(c.a)(Object(c.a)({},t),{},{language:"zh"}))}),e.next=3,fetchAPI(n);case 3:if((r=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,y.common.netFail+"\n"+r.response.result));case 6:if(l=ma.productSchemaRenderCheck(r),i=l.response,o=i.status,u=i.result,o){e.next=10;break}return e.abrupt("return",queryResult(o,u));case 10:return e.abrupt("return",de(u));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function de(e){if(xe=(new DOMParser).parseFromString(e,"text/xml"),console.log(xe),z(xe),window.productSchema=xe,xe.querySelector("parsererror"))return queryResult(!1,y.steps.uneditable);var t=xe.children[0],n=Array.from(t.children).map((function(e){return e.toObject()}));console.log(n)}function pe(){return(pe=Object(i.a)(a.a.mark((function e(t){var n,r,l,c,i,o,u,s,d,p,f;return a.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return"add"===he?(n=ma.productSchemaAddQuery,r=ma.productSchemaAddCheck,c=R):(n=ma.productSchemaUpdateQuery,r=ma.productSchemaUpdateCheck,l=Oe,c=ee),i={xml:t,cat_id:Number(c),language:"zh"},l&&(i.product_id=l),o=n({param_product_top_publish_request:JSON.stringify(i)}),e.next=6,fetchAPI(o);case 6:if((u=e.sent).response.status){e.next=9;break}return e.abrupt("return",queryResult(!1,y.common.netFail+"\n"+u.response.result));case 9:if(s=r(u),d=s.response,p=d.status,f=d.result,p){e.next=13;break}return e.abrupt("return",queryResult(p,f));case 13:return queryResult(!0,"add"===he?y.steps.addSuccess:y.steps.updateSuccess),e.abrupt("return");case 15:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){if(Q){var t=Q.querySelector('itemSchema > field[id="'.concat(e,'"]'));if(t)return me([t])[0]}}function me(e){for(var t=[],n=Array.from(e),r=0;r<n.length;r++){var a=n[r],l=ve(a);l||(l={}),l.xml=a,l.options&&l.options.length&&(l.options=me(l.options)),l.values&&l.values.length&&(l.values=me(l.values)),a.innerHTML&&!a.children.length&&(l.value=a.innerHTML),t.push(l)}return t}function ve(e){var t,n,r=function(e){var t=e.getAttributeObj();return t||(t={}),Object(c.a)(Object(c.a)({},t),{},{xml:e})}(e),a=r.type;return a?("multiComplex"===a?(t=e.querySelectorAll("fields > field"),n=e.querySelectorAll("complex-values > field")):"complex"===a?(t=e.querySelectorAll("fields > field"),n=e.querySelectorAll("complex-value > field")):"multiCheck"===a?(t=e.querySelectorAll("options > option"),n=e.querySelectorAll("values > value")):"multiInput"===a?n=e.querySelectorAll("values > value"):"singleCheck"===a?(t=e.querySelectorAll("options > option"),n=e.querySelectorAll("value")):"input"===a&&(n=e.querySelectorAll("value")),t&&t.length&&(r.options=t),n&&n.length&&(r.values=n),r):r}Object(u.useEffect)((function(){if(console.log("description changed "),J){if(!G.description)return;if(J.length>6e4)return queryResult(!1,y.form.descriptionOverflow);if(J===G.description)return;_e.description=J.replace(/\n/g,"").trim()}}),[J]),Object(u.useEffect)((function(){g(O.a[e.locale])}),[e.locale]),Object(u.useEffect)((function(){return console.log("I want product editing"),S?he?("update"===he?function(e){re.apply(this,arguments)}({product_id:N}):function(e){ie.apply(this,arguments)}({cat_id:R}),function(){console.log("I leave product edit"),_e={}}):queryResult(!1,y.steps.productIdError):k("/")}),[]);var Se=function(e,t){console.log("modified",e,t),_e[e]=t},ke=function(e){return function(t,n){E((function(t){return Object(c.a)(Object(c.a)({},t),{},Object(l.a)({},e,n))}))}};return Object(q.jsxs)(x.a,{title:"Product Edit --\u4ea7\u54c1\u7f16\u8f91",children:[Object(q.jsx)(A,{langPack:y,activeStep:M,setActiveStep:P}),0===M?Object(q.jsxs)(q.Fragment,{children:[Object(q.jsx)(U,{xmlSchema:Q,localization:e,photoCols:ne,rowHeight:200,uploadPhotos:function(e){return ce.apply(this,arguments)},xmlGetField:be,onModified:Se,langPack:y}),Object(q.jsxs)(f.a,{expanded:F.panel1,onChange:ke("panel1"),children:[Object(q.jsxs)(j.a,{expandIcon:Object(q.jsx)(v.a,{}),children:[Object(q.jsx)(b.a,{variant:"h2",sx:{width:"33%",flexShrink:0,color:"coral"},children:y.form.KeyInformation}),Object(q.jsx)(b.a,{sx:{color:"text.secondary"},children:y.steps.panel1})]}),Object(q.jsx)(m.a,{sx:{border:"1px groove"},children:Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(oe,{xmlSchema:Q,langPack:y,xmlGetField:be,onModified:Se})})})]}),Object(q.jsxs)(f.a,{expanded:F.panel2,onChange:ke("panel2"),children:[Object(q.jsxs)(j.a,{expandIcon:Object(q.jsx)(v.a,{}),children:[Object(q.jsx)(b.a,{variant:"h2",sx:{width:"33%",flexShrink:0,color:"red"},children:y.form.ProductAttributes}),Object(q.jsx)(b.a,{sx:{color:"text.secondary"},children:y.steps.panel2})]}),Object(q.jsx)(m.a,{sx:{border:"1px groove"},children:Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(fe,Object(c.a)(Object(c.a)({},G),{},{xmlSchema:Q,langPack:y,xmlGetField:be,onModified:Se}))})})]}),Object(q.jsxs)(f.a,{expanded:F.panel3,onChange:ke("panel3"),children:[Object(q.jsxs)(j.a,{expandIcon:Object(q.jsx)(v.a,{}),children:[Object(q.jsx)(b.a,{variant:"h2",sx:{width:"33%",flexShrink:0,color:"orangered"},children:y.form.productService}),Object(q.jsx)(b.a,{sx:{color:"text.secondary"},children:y.steps.panel3})]}),Object(q.jsx)(m.a,{sx:{border:"1px groove"},children:Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(je,{xmlSchema:Q,langPack:y,xmlGetField:be,onModified:Se})})})]}),Object(q.jsx)("br",{})]}):1===M?Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(ye,{localization:e,finalDescription:J,xmlGetField:be,onModified:Se,xmlSchema:Q,langPack:y})}):2===M?Object(q.jsx)(q.Fragment,{children:Object(q.jsx)(ge.a,{langPack:y,productModified:_e,modificationSubmission:function(){if(!Object.keys(_e).length)return queryResult(!1,y.steps.modificationNull);console.log(_e);var e=Object.values(_e).map((function(e){return e.xml})),t="<itemSchema>";e.forEach((function(e){return t+=e.outerHTML})),t+="</itemSchema>";var n=(new DOMParser).parseFromString(t,"text/xml").firstChild;Array.from(n.querySelectorAll("field > :not(value, values, complex-value, complex-values)")).forEach((function(e){return e.remove()})),function(e){pe.apply(this,arguments)}(t=(t=(t=n.outerHTML.replace(/ xmlns="http:\/\/www.w3.org\/1999\/xhtml"/gi,"")).replace(/inputvalue/g,"inputValue")).encodeNonASCII())}})}):Object(q.jsx)(q.Fragment,{})]})}}}]);
//# sourceMappingURL=13.77868105.chunk.js.map