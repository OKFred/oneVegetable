(this["webpackJsonperp-dashboard"]=this["webpackJsonperp-dashboard"]||[]).push([[15],{450:function(e,t,a){"use strict";a.r(t);var r=a(35),n=a.n(r),o=a(8),u=a(53),i=a(13),l=a(0),c=a(22),d=a(16),s=a(87),f={enUS:{folder:{currentFolder:"please select",needFolderName:"please input name for new folder",addNewFolder:"add new folder",folderNull:"folder not found",dataNull:"data not found"},table:{tableHeader:"Order",trade_id:"Trade id",timeCreated:"Time Created",timeModified:"Time Modified",pay_method:"Method",pay_status:"Status",pay_step:"Step",payTime:"Pay Time",receiveTime:"Receive Time",shouldPayCurrency:"Sale Currency",shouldPayAmount:"Sale Amount",payAmount:"Pay Amount",receiveAmount:"Receive Amount",serviceAmount:"Service Amount",serviceCurrency:"Service Currency",currency:"Currency"},tableToolbar:{payment:"payment",detail:"detail"},form:{dateConversion:"Local Time",orderFundError:"Order fund not found",orderError:"Order not found",startDate:"Start Date",endDate:"End Date",query:"Query",buyerId:"Buyer Member Id"},common:{yes:"OK",no:"Cancel",netFail:"request failed"}},zhCN:{folder:{currentFolder:"\u8bf7\u9009\u62e9",needFolderName:"\u8bf7\u586b\u5199\u6587\u4ef6\u5939\u540d",addNewFolder:"\u65b0\u5efa\u6587\u4ef6\u5939",folderNull:"\u6587\u4ef6\u5939\u4e0d\u5b58\u5728",dataNull:"\u6570\u636e\u4e0d\u5b58\u5728"},table:{tableHeader:"\u8ba2\u5355",trade_id:"\u8ba2\u5355\u53f7",timeCreated:"\u521b\u5efa\u65f6\u95f4",timeModified:"\u4fee\u6539\u65f6\u95f4",pay_method:"\u65b9\u5f0f",pay_status:"\u72b6\u6001",pay_step:"\u6b65\u9aa4",payTime:"\u4ed8\u6b3e\u65f6\u95f4",receiveTime:"\u5230\u8d26\u65f6\u95f4",shouldPayCurrency:"\u5e94\u4ed8\u5e01\u79cd",shouldPayAmount:"\u5e94\u4ed8",payAmount:"\u5b9e\u4ed8",receiveAmount:"\u5230\u8d26",serviceAmount:"\u670d\u52a1\u8d39",serviceCurrency:"\u670d\u52a1\u8d39\u5e01\u79cd",currency:"\u5e01\u79cd"},tableToolbar:{payment:"\u8d44\u91d1",detail:"\u8be6\u60c5"},form:{dateConversion:"\u672c\u5730\u65f6\u95f4",orderFundError:"\u8ba2\u5355\u8d44\u91d1\u672a\u67e5\u5230",orderError:"\u8ba2\u5355\u672a\u67e5\u5230",startDate:"\u5f00\u59cb\u65f6\u95f4",endDate:"\u7ed3\u675f\u65f6\u95f4",query:"\u67e5\u8be2",buyerId:"\u4e70\u5bb6 Member Id"},common:{yes:"\u786e\u5b9a",no:"\u53d6\u6d88",netFail:"\u8bf7\u6c42\u5931\u8d25"}}},m=a(3),b=a(293),y=a(434),p=a(435),h=a(437),j=a(461),O=a(427),v=a(428),g=a(429),_=a(430),x=a(462),C=a(1),w=[],D=[];var A=function(e){var t=e.tableRows,a=e.tableColumns,r=e.page_size,n=e.page,u=e.total,i=e.localization,l=e.langPack,c=e.handleChangePage,d=e.handleChangeRowsPerPage,s=e.onRowClick,f=e.columnVisibilityModel,A=e.setColumnVisibilityModel,S=e.fundAutoQuery,T=e.setFundAutoQuery,M=window.innerHeight>520?window.innerHeight-320:600;return Object(C.jsx)("div",{style:{height:M,width:"100%"},children:Object(C.jsx)(h.a,{experimentalFeatures:{newEditingApi:!0},checkboxSelection:!0,localeText:"zhCN"===i.locale?j.a.components.MuiDataGrid.defaultProps.localeText:{},components:{Toolbar:function(){return Object(C.jsxs)(O.a,{children:[Object(C.jsx)(v.a,{}),Object(C.jsx)(g.a,{}),Object(C.jsx)(_.a,{}),Object(C.jsx)(x.a,{csvOptions:{utf8WithBom:!0,fileName:l.table.tableHeader+"_"+new Date((new Date).valueOf()-60*(new Date).getTimezoneOffset()*1e3).toISOString().replace(/T.*/,"")}}),Object(C.jsx)(b.a,{sx:{padding:"4px 5px"},startIcon:S?Object(C.jsx)(y.a,{}):Object(C.jsx)(p.a,{}),onClick:function(){return T((function(e){return!e}))},children:l.tableToolbar.payment}),Object(C.jsx)("span",{hidden:!w.length})]})}},onRowClick:s,onCellEditCommit:function(e){var a=e.id,r=e.row,n=e.field,u=e.value,i=t.findIndex((function(e){return e.id===a}));if(-1!==i)if(t[i][n]!==u){var l=Object(o.a)(Object(o.a)({},r),{},Object(m.a)({},n,u));D[i]=l}else D[i]=void 0},onStateChange:function(e){var a=e.selection;a.length!==w.length&&(w=a.map((function(e){return t.find((function(t){return t.id===e}))})),console.log(w.length+" selected"))},page:n,pageSize:r,rowCount:u,columns:a,columnVisibilityModel:f,onColumnVisibilityModelChange:A,getRowHeight:function(){return 88},rows:t,rowsPerPageOptions:[10,25,100],disableSelectionOnClick:!0,paginationMode:"server",onPageChange:c,onPageSizeChange:d})})},S=a(452),T=a(278),M=a(85),k=a(223),P=a(445),N=a(438),F=a(396),I=a(439),z=a(398),R=a(402),E={zhCN:z.a,enUS:R.a},q={zhCN:"__-__-__",enUS:"__/__/____"};var Q=function(e){var t=e.localization,a=e.langPack,r=e.startDate,n=e.endDate,u=e.setDate,i=e.setDateType,l=e.autoQuery,c=e.buyerId,d=e.setBuyerId,s=t.locale,f=[{value:0,label:a.table.timeCreated},{value:100,label:a.table.timeModified}];return Object(C.jsxs)("div",{style:{marginBottom:"7px",display:"flex",flexDirection:"row"},children:[Object(C.jsx)(S.a,{title:a.form.buyerId,children:Object(C.jsx)(T.a,{margin:"normal",id:c,variant:"outlined",sx:{margin:"0px"},label:Object(C.jsx)(M.a,{variant:"h3",sx:{color:"rgb(133, 133, 133)",fontWeight:"normal"},children:a.form.buyerId}),defaultValue:c,onBlur:function(e){return d(e.target.value)}})},"buyerId"),Object(C.jsxs)(F.a,{dateAdapter:N.a,locale:E[s],children:[Object(C.jsx)(I.a,{label:a.form.startDate,mask:q[s],value:r,onChange:function(e){return u(e,"startDate")},renderInput:function(e){return Object(C.jsx)(S.a,{title:a.form.dateConversion,children:Object(C.jsx)(T.a,Object(o.a)({},e))})}}),Object(C.jsx)(I.a,{label:a.form.endDate,mask:q[s],value:n,onChange:function(e){return u(e,"endDate")},renderInput:function(e){return Object(C.jsx)(S.a,{title:a.form.dateConversion,children:Object(C.jsx)(T.a,Object(o.a)({},e))})}})]}),Object(C.jsx)(k.a,{sx:{marginLeft:"50px",marginRight:"50px",width:100},children:Object(C.jsx)(P.a,{defaultValue:0,step:100,marks:f,onChangeCommitted:function(e,t){return i(0===t?"dateCreated":"dateModified")}})}),Object(C.jsx)(b.a,{onClick:function(){return l()},variant:"outlined",children:a.form.query})]})},V=[];t.default=function(){console.log("order app running");var e=Object(d.f)(),t=/zh/i.test(navigator.language)?"zhCN":"enUS",a=Object(c.c)((function(e){return e.globalization})),r=Object(l.useState)(a.baseData.loginData),m=Object(i.a)(r,1)[0],b=Object(c.c)((function(e){return e.localization})),y=Object(l.useState)(f[b.locale]),p=Object(i.a)(y,2),h=p[0],j=p[1],O=Object(l.useState)(0),v=Object(i.a)(O,2),g=v[0],_=v[1],x=Object(l.useState)(10),w=Object(i.a)(x,2),D=w[0],S=w[1],T=Object(l.useState)(0),M=Object(i.a)(T,2),k=M[0],P=M[1],N=Object(l.useState)([]),F=Object(i.a)(N,2),I=F[0],z=F[1],R=Object(l.useState)([]),E=Object(i.a)(R,2),q=E[0],H=E[1],B=Object(l.useState)({}),G=Object(i.a)(B,2),L=G[0],U=G[1],J=Object(l.useState)(!1),W=Object(i.a)(J,2),K=W[0],X=W[1],Y=Object(l.useState)(null),Z=Object(i.a)(Y,2),$=Z[0],ee=Z[1],te=Object(l.useState)(null),ae=Object(i.a)(te,2),re=ae[0],ne=ae[1],oe=Object(l.useState)("dateCreated"),ue=Object(i.a)(oe,2),ie=ue[0],le=ue[1],ce=Object(l.useState)(""),de=Object(i.a)(ce,2),se=de[0],fe=de[1];Object(l.useEffect)((function(){return j(f[b.locale||t]),function(){}}),[b.locale]),Object(l.useEffect)((function(){return($||re)&&be(),function(){}}),[$,re,ie]),Object(l.useEffect)((function(){return q.length&&K?function(){pe.apply(this,arguments)}():Oe(),function(){}}),[q,K]),Object(l.useEffect)((function(){return console.log("I am at order"),m?(be(),Oe(),function(){console.log("I leave order")}):e("/")}),[]);var me=function(e){var t=60*((new Date).isPDT()?-7:-8)*60*1e3;return new Date(new Date(e).Format("yyyy-MM-dd 00:00:00")).valueOf()+60*(new Date).getTimezoneOffset()*1e3+t};function be(e){var t={role:"seller",start_page:g,page_size:D};return($||re)&&("dateCreated"===ie?($&&(t.create_date_start={time:me($)}),re&&(t.create_date_end={time:me(re)})):"dateModified"===ie&&($&&(t.modified_date_start={time:me($)}),re&&(t.modified_date_end={time:me(re)}))),se&&(t.other_login_id=se),e&&Object.assign(t,e),function(e){return ye.apply(this,arguments)}({param_trade_ecology_order_list_query:JSON.stringify(t)})}function ye(){return(ye=Object(u.a)(n.a.mark((function e(t){var a,r,u,i,l,c,d,s,f;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ma.sellerOrderQuery(t),e.next=3,fetchAPI(a);case 3:if((r=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,r.response.result));case 6:if(u=ma.sellerOrderCheck(r),i=u.response,l=i.status,c=i.result,console.log(c),l){e.next=15;break}if(P(0),H([]),0!==l){e.next=14;break}return e.abrupt("return",queryResult(!1,h.form.orderError));case 14:return e.abrupt("return",queryResult(l,c));case 15:return d=c.order_list,s=c.total_count,P(s),f=d.trade_ecology_order.map((function(e){return Object(o.a)(Object(o.a)({},e),{},{id:e.trade_id})})),e.abrupt("return",H(f));case 19:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function pe(){return(pe=Object(u.a)(n.a.mark((function e(){return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(q.length){e.next=2;break}return e.abrupt("return");case 2:return(V=[]).realLength=0,q.forEach((function(e){console.log("checking funds"),he({e_trade_id:e.trade_id})})),e.abrupt("return");case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function he(e){return je.apply(this,arguments)}function je(){return(je=Object(u.a)(n.a.mark((function e(t){var a,r,u,i,l,c,d,s;return n.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=ma.sellerOrderFundQuery(t),e.next=3,fetchAPI(a);case 3:if((r=e.sent).response.status){e.next=6;break}return e.abrupt("return",queryResult(!1,r.response.result));case 6:if(u=ma.sellerOrderFundCheck(r),i=u.response,l=i.status,c=i.result,d=u.request.data.e_trade_id,s=q.findIndex((function(e){return e.trade_id===d})),-1!==s){e.next=13;break}return V=[],e.abrupt("return");case 13:if(l?V[s]=c:(V[s]={},queryResult(!1,h.form.orderFundError)),V.realLength++,V.realLength===q.length){e.next=17;break}return e.abrupt("return");case 17:V=V.map((function(e){var t=e.service_fee,a=e.fund_pay_list;if(t){var r=t.amount,n=t.currency;e.serviceAmount=r,e.serviceCurrency=n}if(a){var o=a.fund_pay[0],u=o.pay_amount,i=o.pay_time,l=o.receive_time,c=o.should_pay_amount,d=o.receive_amount;Object.assign(e,a.fund_pay[0]),c&&(e.shouldPayCurrency=c.currency,e.shouldPayAmount=c.amount),u&&(e.payCurrency=u.currency,e.payAmount=u.amount),d&&(e.receiveCurrency=d.currency,e.receiveAmount=d.amount),i&&(e.payTime=i.timestamp),l&&(e.receiveTime=l.timestamp)}return e})),H((function(e){for(var t=[],a=0;a<e.length;a++)t.push(Object(o.a)(Object(o.a)({},e[a]),V[a]));return console.log(t),t})),V=[],Oe({fund:!0});case 21:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Oe(e){var t=[{field:"trade_id",headerName:h.table.tableHeader,flex:1},{field:"timeOrderCreated",flex:1,valueGetter:function(e){return e.row},valueFormatter:function(e){var t=e.value;return new Date(t.timeOrderCreated).Format("yyyy-MM-dd hh:mm")},headerName:h.table.timeCreated},{field:"timeOrderModified",flex:1,valueGetter:function(e){return e.row},valueFormatter:function(e){var t=e.value;return new Date(t.timeOrderModified).Format("yyyy-MM-dd hh:mm")},headerName:h.table.timeModified}];e&&(e.fund&&t.push({field:"pay_status",headerName:h.table.pay_status,flex:1,sortable:!0},{field:"receiveAmount",headerName:h.table.receiveAmount,flex:1,sortable:!0},{field:"payAmount",headerName:h.table.payAmount,flex:1,sortable:!0},{field:"shouldPayAmount",headerName:h.table.shouldPayAmount,flex:1,sortable:!0},{field:"pay_step",headerName:h.table.pay_step,flex:1,sortable:!0},{field:"pay_method",headerName:h.table.pay_method,flex:1,sortable:!0},{field:"serviceAmount",headerName:h.table.serviceAmount,flex:1,sortable:!0},{field:"shouldPayCurrency",headerName:h.table.currency,flex:.5,sortable:!0},{field:"receiveTime",valueGetter:function(e){return e.row},valueFormatter:function(e){var t=e.value;return t.receiveTime?new Date(t.receiveTime).Format("yyyy-MM-dd hh:mm"):""},headerName:h.table.receiveTime,flex:1,sortable:!0},{field:"payTime",valueGetter:function(e){return e.row},valueFormatter:function(e){var t=e.value;return t.payTime?new Date(t.payTime).Format("yyyy-MM-dd hh:mm"):""},headerName:h.table.payTime,flex:1,sortable:!0}));z(t),U({pay_step:!1,pay_method:!1})}return Object(C.jsxs)(s.a,{title:"Order --\u8ba2\u5355",children:[Object(C.jsx)(Q,{localization:b,langPack:h,startDate:$,endDate:re,setDate:function(e,t){var a=function(e,t){return!(e.valueOf()>=t.valueOf())||queryResult(!1,"date error")};null==$||null==re?"startDate"===t?ee(e):"endDate"===t&&ne(e):"startDate"===t?a(e,re)&&ee(e):"endDate"===t&&a($,e)&&ne(e)},setDateType:le,autoQuery:be,buyerId:se,setBuyerId:fe}),Object(C.jsx)(A,{tableRows:q,tableColumns:I,page_size:D,page:g,total:k,localization:b,langPack:h,columnVisibilityModel:L,setColumnVisibilityModel:U,handleChangePage:function(e){_(e),Oe(),be({start_page:e})},handleChangeRowsPerPage:function(e){S(e),Oe(),be({page_size:e})},fundAutoQuery:K,setFundAutoQuery:X,onRowClick:function(e,t){}})]})}}}]);
//# sourceMappingURL=15.5c87cb30.chunk.js.map